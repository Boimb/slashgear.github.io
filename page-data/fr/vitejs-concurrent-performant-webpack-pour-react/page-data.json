{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/fr/vitejs-concurrent-performant-webpack-pour-react/",
    "result": {"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.slashgear.dev"}},"config":{"html":"<p>Ecrit par <strong>Antoine Caron</strong> qui vit et travaille à Lyon et développe des choses utiles à <a href=\"https://www.bedrockstreaming.com/\">Bedrock</a>.\nTu devrais le suivre sur <a href=\"https://twitter.com/Slashgear_\">Twitter</a>.\nN’hésites pas à aller voir <a href=\"/conferences\">ses conférences sur la page dédiée</a>.\nSi vous voulez voir mon parcours pro, <a href=\"/resume\">mon CV est disponible ici en 🇬🇧</a>.</p>","fields":{"slug":"/fr/"},"frontmatter":{"title":"Antoine Caron","language":"fr"}},"markdownRemark":{"id":"3ab304a4-ad7e-5b53-a27e-dc014ae712f9","excerpt":"Après avoir traité sur ce blog dans plusieurs articles de webpack, j’ai commencé une nouvelle série d’articles sur les bundlers nouvelles…","html":"<p>Après avoir traité sur ce blog <a href=\"/fr/webpack/\">dans plusieurs articles de webpack</a>, j’ai commencé une nouvelle série d’articles sur les bundlers nouvelles générations.\nIl semblerait qu’on rentre aujourd’hui dans une nouvelle ère du tooling web.</p>\n<p>Ayant présenté <a href=\"../esbuild-bundler-incroyablement-rapide-et-prometteur\">esbuild et ses features intéressantes</a>, il me semble logique de traiter les bundler <em>“petits frères”</em>.\nCommençons donc par Vite, un projet de la communauté VueJS et lancé par <a href=\"https://github.com/yyx990803\">Evan You</a>.</p>\n<h2 id=\"un-même-constat-de-départ\" style=\"position:relative;\"><a href=\"#un-m%C3%AAme-constat-de-d%C3%A9part\" aria-label=\"un même constat de départ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Un même constat de départ</h2>\n<p>Avec <code class=\"language-text\">Vite</code> on est dans le même constat qu’avec <code class=\"language-text\">esbuild</code>.\nGlobalement la communauté est contente des outils actuels même s’ils accusent quelques soucis de performances.</p>\n<p>Comme je le disais dans mon précédent article, avoir un gros projet JS aujourd’hui c’est souvent avoir un environnement de dev et de prod parfois un peu lent.\nEntre le choix des outils qui n’exploitent pas suffisamment la parallelization ou l’optimisation mémoire, ou les opérations répétitives qui n’exploitent que très peu le caching, on peut facilement identifier des coupables à ces lenteurs.</p>\n<p><em>NB: J’ai proposé quelques solutions pour <a href=\"/hunting-webpack-performances/\">améliorer les performances de vos build webpack dans cet article</a>.</em></p>\n<p>De plus, les outils de <em>deuxième génération</em> (comme Webpack, Rollup, Parcel) n’ont pas pu gérer dès leur début <a href=\"https://caniuse.com/?search=es6\">des fonctionnalités récentes de nos navigateurs comme les ESmodules</a>.</p>\n<h2 id=\"cest-quoi-lidée-\" style=\"position:relative;\"><a href=\"#cest-quoi-lid%C3%A9e-\" aria-label=\"cest quoi lidée  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C’est quoi l’idée ?</h2>\n<p>L’idée <em>révolutionnaire</em> de <code class=\"language-text\">Vite</code> est d’allier deux outils pour deux besoins différents afin d’optimiser le build pour qu’il soit le plus rapide possible.\nLes deux outils qui composent <code class=\"language-text\">Vite</code> sont <code class=\"language-text\">esbuild</code> et <code class=\"language-text\">Rollup</code>, rien de bien nouveau donc.\nMais pourquoi deux outils de bundling ?\nGlobalement, pour deux raisons:</p>\n<ul>\n<li>\n<p>Nos dépendances ne changent pas souvent, réévaluer l’arborescence de leurs modules à chaque build n’est donc pas nécessaire.\nOn peut donc générer le bundle de nos <em>vendor</em> une fois pour tout avec un outil optimisé comme <code class=\"language-text\">esbuild</code>.\nCe bundler étant hyper rapide, il permet un démarrage rapide du server.</p>\n</li>\n<li>\n<p>Les modules de notre code source sont beaucoup amenés à changer contrairement aux dépendances.\n<code class=\"language-text\">Vite</code> utilise donc un autre traitement basé sur les ESM qui fonctionnent nativement sur les navigateurs récents.</p>\n</li>\n</ul>\n<p>N’hésitez pas à lire <a href=\"https://vitejs.dev/guide/why.html\">cette page de la doc</a> pour plus de détails.</p>\n<h2 id=\"dans-les-faits-comment-ça-marche-\" style=\"position:relative;\"><a href=\"#dans-les-faits-comment-%C3%A7a-marche-\" aria-label=\"dans les faits comment ça marche  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dans les faits, comment ça marche ?</h2>\n<p>Afin de jouer un peu avec l’outil, je vous propose une petite présentation par le biais d’un projet exemple.\nDéjà commençons par init un projet exemple.\nJe vous montre ici comment le créer et vous mets <a href=\"https://github.com/Slashgear/example-vite\">le lien du repository github dans lequel je l’ai publié</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">mkdir</span> <span class=\"token string\">\"example-vite\"</span>\n<span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"example-vite\"</span>\n\n<span class=\"token function\">git</span> init\n<span class=\"token function\">yarn</span> init -y</code></pre></div>\n<p>Pour installer <code class=\"language-text\">Vite</code> rien de plus simple, il vous suffit d’une dépendance.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D vite</code></pre></div>\n<p>Pour les besoins de cet exemple, je vous propose un exemple avec React (on trouve déjà de nombreux exemples avec Vue 😉)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> react react-dom</code></pre></div>\n<p>Ajoutons 3 commandes usuelles pour lancer <code class=\"language-text\">Vite</code> dans le fichier <code class=\"language-text\">package.json</code></p>\n<p><em>package.json</em></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"vite build\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"vite preview\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Il nous faut enfin quelques petits fichiers source pour que <code class=\"language-text\">Vite</code> ait quelque chose à se mettre sous la dent.</p>\n<p><em>index.html</em></p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Example Application with Vite<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/src/main.jsx<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><em>src/main.jsx</em></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">React.StrictMode</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Hello world dear readers ! </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">React.StrictMode</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Maintenant il ne vous reste qu’à démarrer le server de developement avec cette commande.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> dev</code></pre></div>\n<p>🎉 Normalement, en quelques millisecondes <code class=\"language-text\">Vite</code> a démarré un server et si vous allez sur <code class=\"language-text\">https://localhost:3000</code> qui vous présente cette magnifique application.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ecfcfb4ed066b92cd028720b818f6498/a878e/step1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAXElEQVQ4y+3OMQ4AIQgEQP//P4Oh4QsqNha6F3jAnSRXuolZCpmQiAjMDBFBztm7lOI954Rl743TpForeu9QVdhs3VrDGANrrTj49SGCOWgLb+/3C6O54AUveAI+igynQ7DWHDgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ecfcfb4ed066b92cd028720b818f6498/ba381/step1.webp 200w,\n/static/ecfcfb4ed066b92cd028720b818f6498/7f61c/step1.webp 400w,\n/static/ecfcfb4ed066b92cd028720b818f6498/d00b9/step1.webp 800w,\n/static/ecfcfb4ed066b92cd028720b818f6498/92f8c/step1.webp 1200w,\n/static/ecfcfb4ed066b92cd028720b818f6498/fad48/step1.webp 1600w,\n/static/ecfcfb4ed066b92cd028720b818f6498/8df42/step1.webp 2048w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ecfcfb4ed066b92cd028720b818f6498/772e8/step1.png 200w,\n/static/ecfcfb4ed066b92cd028720b818f6498/e17e5/step1.png 400w,\n/static/ecfcfb4ed066b92cd028720b818f6498/5a190/step1.png 800w,\n/static/ecfcfb4ed066b92cd028720b818f6498/c1b63/step1.png 1200w,\n/static/ecfcfb4ed066b92cd028720b818f6498/29007/step1.png 1600w,\n/static/ecfcfb4ed066b92cd028720b818f6498/a878e/step1.png 2048w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ecfcfb4ed066b92cd028720b818f6498/5a190/step1.png\"\n            alt=\"screenshot\"\n            title=\"screenshot\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>On va pas se mentir c’est un peu triste, voyons voir comment <code class=\"language-text\">Vite</code> s’en sort si on lui ajoute du CSS.\nOn va mettre une magnifique couleur <a href=\"https://fr.wikipedia.org/wiki/Chartreuse_(liqueur)\">chartreuse</a> à ce titre.\nAjoutons d’abord la feuille de style suivante.</p>\n<p><em>src/index.css</em></p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">h1</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> chartreuse<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Il nous suffit ensuite de rajouter un import vers ce nouveau fichier.</p>\n<p><em>src/main.jsx</em></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'./index.css'</span></code></pre></div>\n<p>Voilà, maintenant vous avez une magnifique couleur qui <a href=\"https://webaim.org/articles/contrast/\">manque clairement de contraste pour être accessible</a> !</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e2aaad3951aca659eb0a22b3c34b502a/a878e/step2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAWElEQVQ4y+2OuwqAMAwA+///p4iLsw/Ex2ALtifJB2gDjrkMlyEcCRMtCz0rAyONeqZT3ySEQqGWcLEROUicyC6O7OpMtge/DiwxDRbe5/cPrXjQgx6sCT4V3alXZqWkEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e2aaad3951aca659eb0a22b3c34b502a/ba381/step2.webp 200w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/7f61c/step2.webp 400w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/d00b9/step2.webp 800w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/92f8c/step2.webp 1200w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/fad48/step2.webp 1600w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/8df42/step2.webp 2048w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e2aaad3951aca659eb0a22b3c34b502a/772e8/step2.png 200w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/e17e5/step2.png 400w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/5a190/step2.png 800w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/c1b63/step2.png 1200w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/29007/step2.png 1600w,\n/static/e2aaad3951aca659eb0a22b3c34b502a/a878e/step2.png 2048w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e2aaad3951aca659eb0a22b3c34b502a/5a190/step2.png\"\n            alt=\"screenshot avec couleur\"\n            title=\"screenshot avec couleur\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Si vous tenter maintenant de lancer la commande <code class=\"language-text\">yarn build</code>, vous pouvez observer que <code class=\"language-text\">Vite</code> va vous construire un dossier <code class=\"language-text\">dist</code>.\nSans paramétrage j’ai directement ces différentes ressources prêtent à être déployées sur un server statique.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 506px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/852748a3553e76e77e6a76bfd5bb4f86/29f4e/dist_screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbklEQVQoz4WSy26DMBRE8z3dtCEkEF62IfiFeaRJ2qYvqYtU6qYf0J+fyiZEKEXqYsT1veIw48uM5Bt0hyNePk4ohQdZBcgYQZwxJIQizigSwiZlZ+O5rWcZKyBNi/3xFbIKUcoQcZYjSvML9D+NwbMoJSCsAMkLnL5/0NwraHODuvMg9MpBLfxafZ+NkpwdDnZTmiPnErySaPcapVhC6AAkT1HwCHkZYyPWrmabxPVpkVxgvVvWAwe7qzjBQXf43L2DKx91OweXAZTxnZrtLUw7d7Luq8abBg6HdUoglcbTTkMoH6b1UIrw8rLQS+h64c5chn8ij4C9opSCS4HnfYGChy6yi1lGblk29vABroKrxZyB4w0F6wRCabw9aAi9gK59mMZz0Lq7cxpi29rO7H1ap1eRrTsCsztA1RzbZuEiWZCslu5pl5BSchZFxjLXm7hDisSunBCYLwH5mEJWc1TNwsW0Lm28/reY1jjyLyXLYOpkjK3ZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/852748a3553e76e77e6a76bfd5bb4f86/ba381/dist_screenshot.webp 200w,\n/static/852748a3553e76e77e6a76bfd5bb4f86/7f61c/dist_screenshot.webp 400w,\n/static/852748a3553e76e77e6a76bfd5bb4f86/6b97b/dist_screenshot.webp 506w\"\n              sizes=\"(max-width: 506px) 100vw, 506px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/852748a3553e76e77e6a76bfd5bb4f86/772e8/dist_screenshot.png 200w,\n/static/852748a3553e76e77e6a76bfd5bb4f86/e17e5/dist_screenshot.png 400w,\n/static/852748a3553e76e77e6a76bfd5bb4f86/29f4e/dist_screenshot.png 506w\"\n            sizes=\"(max-width: 506px) 100vw, 506px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/852748a3553e76e77e6a76bfd5bb4f86/29f4e/dist_screenshot.png\"\n            alt=\"dist directory screenshot\"\n            title=\"dist directory screenshot\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>On peut observer que nativement <code class=\"language-text\">Vite</code> exporte 2 bundle javascript (1 pour les sources, 1 pour les <em>vendors/dépendances</em>) et un bundle CSS qui exporte le style qui a été importé dans votre application.\nEt la c’est clairement un gros plus de <code class=\"language-text\">Vite</code> par rapport à la concurrence des autres outils (quoique parcel propose un peu la même logique).\nLe <em>build</em> est extrêmement rapide et fait ce qu’on pourrait espérer de lui sans qu’on ait à le configurer.\nDésolé mais je trouve ça génial!</p>\n<p>Je ne sais pas si vous connaissez <a href=\"https://www.npmjs.com/package/react-refresh\"><code class=\"language-text\">react-refresh</code></a>, le package officiel de React qui permet d’optimiser le rafraichissent auto d’une application React.\nCe package vous permet de mettre à jour vos composants React à chaud sans qu’ils perdent leur <em>state</em>.\n<code class=\"language-text\">Vite</code> même étant né de la communauté VueJS, n’est pas spécifiquement orienté vers un framework frontend.\nLes outils comme <code class=\"language-text\">react-refresh</code> ne sont donc pas inclus par défaut.\nIl vous faut donc le définir dans de la configuration.\nMalheureusement, <code class=\"language-text\">Vite</code> s’en sort pas mieux que les autres outils ; on est forcé de définir un énième fichier de config à la racine du projet.</p>\n<p>Installons donc le plugin vite nécessaire :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D @vitejs/plugin-react-refresh</code></pre></div>\n<p><em>vite.config.js</em></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defineConfig <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vite'</span>\n<span class=\"token keyword\">import</span> reactRefresh <span class=\"token keyword\">from</span> <span class=\"token string\">'@vitejs/plugin-react-refresh'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">reactRefresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Maintenant j’ai voulu tester des features un peu plus avancées qu’on peut espérer avec un bundler de qualité.\nJ’ai donc setup une application single page qui utilise du <em>lazy loading</em>.\nJe ne vous présente pas comment j’ai fait dans cet article, ce serait un peu trop long mais vous pouvez directement aller la <a href=\"https://example-vite.netlify.app/\">tester dans votre navigateur</a>.</p>\n<p>Alors clairement pour le <em>lazy loading</em> c’est clairement simple avec <code class=\"language-text\">Vite</code>, je suis épaté!\nL’outil détecte immédiatement mon usage de l’import dynamique <code class=\"language-text\">import()</code> pour générer un chunk séparé pour le JS mais aussi le CSS.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Content <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./lazy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 570px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6eef089760b01de631514fceb06f8bd4/432e7/lazy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABkElEQVQoz32S626cMBCF95Gi3ZRwMb5ysQ0LWWXTKqTVNq0q9f1f4FRjBwIq7Y/DDAZ/c2bsgzQVrtMNfnCo7RFcSeSlQsEVmJBg4u9Y8Pl9m5MO9Lh8fsX4NKIfM0jDwJUIioB9UcEZtoYeCkq4wPg8Yfr+E427Qz+eUNsUGTPIS70oYzHO7tfQjUNaLLgA1waXR4vWJXD9Pao2Q+uTRd05FuKKb6Ab4No21zVu0wjnHwKwsWmA+PMJ1iew3Sc07gGqYqsZ7zgk5VyiMjV+XL+htTnc+RQ2E5hE0LkIuf1w90+ggNE13q5f4bskwMgRgbrhiH48Lmv/bXkBlhLGVPj1MoWWaTPN0L87nOdIa1t3uw7j3asbid+3Bl2foPHJ0qpfAelQ1q3uOIwfciZQigrTc4+mTUObsyNqd7jchQLdEA9JaL4/Q1rMCg7tLPovjxiCq3tUNs5LNxmYFCglBxMUY063IufxMGOMOmijYLSBfVIY3hScSzGMCZzL0fUp2pZBaQ2tFejfEOfcyPf4oT9Lmqd7OVS57QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6eef089760b01de631514fceb06f8bd4/ba381/lazy.webp 200w,\n/static/6eef089760b01de631514fceb06f8bd4/7f61c/lazy.webp 400w,\n/static/6eef089760b01de631514fceb06f8bd4/048c8/lazy.webp 570w\"\n              sizes=\"(max-width: 570px) 100vw, 570px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6eef089760b01de631514fceb06f8bd4/772e8/lazy.png 200w,\n/static/6eef089760b01de631514fceb06f8bd4/e17e5/lazy.png 400w,\n/static/6eef089760b01de631514fceb06f8bd4/432e7/lazy.png 570w\"\n            sizes=\"(max-width: 570px) 100vw, 570px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6eef089760b01de631514fceb06f8bd4/432e7/lazy.png\"\n            alt=\"lazy loading dist screenshot\"\n            title=\"lazy loading dist screenshot\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"les-points-forts-de-vite\" style=\"position:relative;\"><a href=\"#les-points-forts-de-vite\" aria-label=\"les points forts de vite permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Les points forts de Vite</h2>\n<p>Il est clair que <code class=\"language-text\">Vite</code> possède de nombreux avantages et fonctionnalités très sympathiques.\nOutre sa vitesse incroyable, je tiens quand même à noter que ce bundler propose une <em>autoconfiguration</em> vraiment bien pensée.</p>\n<p>Dans la démo que je vous proposais précédemment, je ne vous ai pas présenté le fait que <code class=\"language-text\">Vite</code> gère nativement et sans configuration les <em>fichiers statiques, les Web Workers, les binaires WASM</em>.\nMais cela ne s’arrête pas la, force est de constater que cet outil <em>magique</em> supporte également nativement le <strong>JSX et Typescript</strong>.</p>\n<p>Coté gestion du Style, <code class=\"language-text\">Vite</code> n’est pas en reste.\nSans plugin ni configuration, il vous permet de gérer les <code class=\"language-text\">@import</code> CSS, les préprocesseurs comme <strong>SASS et LESS, les CSS modules</strong> et même le postprocesseur <em>PostCSS</em> (si vous définissez une configuration).</p>\n<p>Plus anecdotique, <code class=\"language-text\">Vite</code> sait gérer vos fichier <code class=\"language-text\">.env</code> pour gérer vos variables d’environnement grâce à <a href=\"https://github.com/motdotla/dotenv\">dotenv</a>.</p>\n<p>Mais la fonctionnalité qui m’a complètement scotché, c’est la gestion plutôt simple à setup du <a href=\"https://tech.bedrockstreaming.com/spa-mode-isomorphism-js/\">SSR</a>.</p>\n<p><img src=\"/0e9e962814ce9f4e10f1810913a40893/surprise.gif\" alt=\"surprise\"></p>\n<p>C’est la première fois que je vous parle d’un <em>bundler</em> qui gère nativement le <strong>Server Side Rendering</strong>.\nJ’utilise d’autres outils en production pour les différentes applications que je développe.\nMalheureusement, il est encore très compliqué de mettre en place une telle architecture (même avec des outils comme Webpack).</p>\n<p>On constate donc que les développeurs se tournent principalement vers des solutions clés en main comme Next et Nuxt pour gérer ces problématiques à leur place.\nCe n’est pas une mauvaise chose en soit.\nJe pense cependant qu’il est parfois nécessaire dans certains projets de prendre la main sur cette fonctionnalité pour des besoins business.\nOn ne peut donc que se réjouir que des outils comme <code class=\"language-text\">Vite</code> y ait pensé.\nJe vous invite à aller <a href=\"https://vitejs.dev/guide/ssr.html#ssr-externals\">lire cette page de la documentation de <code class=\"language-text\">Vite</code></a> pour comprendre comment mettre en place cela.</p>\n<h2 id=\"du-coup-on-arrête-webpack-\" style=\"position:relative;\"><a href=\"#du-coup-on-arr%C3%AAte-webpack-\" aria-label=\"du coup on arrête webpack  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Du coup on arrête webpack ?</h2>\n<p>Après cette présentation élogieuse de cet outil on pourrait se poser la question oui.\nCependant, il ne faut pas oublier une règle assez simple.</p>\n<blockquote>\n<p>Tout ce qu’un outil à tendance à faire magiquement à votre place devient souvent bien plus compliqué à customiser.</p>\n</blockquote>\n<p>Les nombreux choix que <code class=\"language-text\">Vite</code> semble faire pour améliorer la <em>developpeur experience</em> m’inquiètent un peu.\nJ’ai un peu peur que toute cette configuration par défaut ne fissent par être compliqué à maintenir par les équipes de <code class=\"language-text\">Vite</code>.</p>\n<p>Contrairement à <code class=\"language-text\">esbuild</code> qui a le leitmotiv <em>“je souhaite proposer un outil qui fait peu de choses mais qui le fait très bien”</em>, on a ici un outil qui fait beaucoup de promesses.\nIl faut cependant reconnaitre que <code class=\"language-text\">Vite</code> propose également d’utiliser et de définir des plugins pour étendre ses fonctionnalités sans pour autant les rendre native à l’outil principal.</p>\n<p>De plus, il ne faut pas oublier que <code class=\"language-text\">Vite</code> est également basé sur <code class=\"language-text\">Rollup</code>, un bundler deuxième génération qui profite lui d’un riche écosystem de plugin qui sont pour la plupart compatible.\nSeulement la configuration de Rollup est à mes yeux très compliqué à éditer et maintenir, j’espère donc pour vous que vous n’aurez pas à y toucher si vous êtes tentés de tester <code class=\"language-text\">Vite</code> sur vos applications.</p>\n<p>Je tiens quand même à souligner que quelques outils comme VuePress proposent aujourd’hui une alternative <a href=\"https://vitepress.vuejs.org/\">Vitepress</a> qui utilise <code class=\"language-text\">Vite</code> comme bundler.</p>\n<p>Avant de sauter sur la solution <code class=\"language-text\">Vite</code>, je vous propose de tester un autre bundler de troisième génération qui fait beaucoup parler: <a href=\"https://www.snowpack.dev/\">Snowpack</a></p>\n<blockquote>\n<p>Stay tuned!</p>\n</blockquote>","headings":[{"value":"Un même constat de départ"},{"value":"C’est quoi l’idée ?"},{"value":"Dans les faits, comment ça marche ?"},{"value":"Les points forts de Vite"},{"value":"Du coup on arrête webpack ?"}],"wordCount":{"words":1417},"tableOfContents":"<ul>\n<li><a href=\"#un-m%C3%AAme-constat-de-d%C3%A9part\">Un même constat de départ</a></li>\n<li><a href=\"#cest-quoi-lid%C3%A9e-\">C’est quoi l’idée ?</a></li>\n<li><a href=\"#dans-les-faits-comment-%C3%A7a-marche-\">Dans les faits, comment ça marche ?</a></li>\n<li><a href=\"#les-points-forts-de-vite\">Les points forts de Vite</a></li>\n<li><a href=\"#du-coup-on-arr%C3%AAte-webpack-\">Du coup on arrête webpack ?</a></li>\n</ul>","frontmatter":{"title":"Vite, le remplaçant à webpack ?!😮","date":"March 26, 2021","dateJson":"2021-03-26","translations":["en","vite-webpack-killer"],"description":"Après avoir étudié des solutions comme Webpack et Esbuild, il me fallait m'intéresser aux outils comme Vite qui fait partie à mes yeux d'une nouvelle génération.","language":"fr","tags":["webpack","esbuild","vitejs","bundler"],"hero":{"childImageSharp":{"fluid":{"aspectRatio":1.7730496453900708,"src":"/static/c20149934693e773dc7e6cf7619d7b04/a7715/vitejs.jpg","srcSet":"/static/c20149934693e773dc7e6cf7619d7b04/8f7df/vitejs.jpg 250w,\n/static/c20149934693e773dc7e6cf7619d7b04/0f3a1/vitejs.jpg 500w,\n/static/c20149934693e773dc7e6cf7619d7b04/a7715/vitejs.jpg 1000w,\n/static/c20149934693e773dc7e6cf7619d7b04/ec6c5/vitejs.jpg 1280w","srcWebp":"/static/c20149934693e773dc7e6cf7619d7b04/e30b5/vitejs.webp","srcSetWebp":"/static/c20149934693e773dc7e6cf7619d7b04/7ca0e/vitejs.webp 250w,\n/static/c20149934693e773dc7e6cf7619d7b04/e9589/vitejs.webp 500w,\n/static/c20149934693e773dc7e6cf7619d7b04/e30b5/vitejs.webp 1000w,\n/static/c20149934693e773dc7e6cf7619d7b04/135cd/vitejs.webp 1280w","sizes":"(max-width: 1000px) 100vw, 1000px"},"image":{"src":"/static/c20149934693e773dc7e6cf7619d7b04/10d63/vitejs.jpg"},"image16x9":{"src":"/static/c20149934693e773dc7e6cf7619d7b04/6edcc/vitejs.jpg"},"image4x3":{"src":"/static/c20149934693e773dc7e6cf7619d7b04/e14ae/vitejs.jpg"},"image1x1":{"src":"/static/c20149934693e773dc7e6cf7619d7b04/db124/vitejs.jpg"}}}}},"relatedPosts":{"edges":[{"node":{"excerpt":"Après webpack, esbuild et vitejs, prenons le temps d’étudier le cas de snowpack.\nCe dernier semble se faire un petit nom dans l’écosystème…","fields":{"slug":"/fr/que-vaut-snowpack/"},"timeToRead":7,"frontmatter":{"title":"🗻 Snowpack 🗻 le remplaçant de webpack ?️","date":"June 02, 2021","dateJson":"2021-06-02","description":"Après des articles sur esbuild, vite, je vous propose de découvrir ensemble snowpack afin de se faire un avis.","tags":["webpack","snowpack","vitejs","bundler"]}}},{"node":{"excerpt":"Cela fait plusieurs années que je joue avec les bundlers JS.\nRestant convaincu de la nécessité de l’usage de ces outils (ne me laissez pas…","fields":{"slug":"/fr/esbuild-bundler-incroyablement-rapide-et-prometteur/"},"timeToRead":6,"frontmatter":{"title":"Esbuild, le bundler incroyablement rapide 💨 et prometteur 📈 !","date":"March 14, 2021","dateJson":"2021-03-14","description":"Jouant avec les bundler traditionnels comme webpack depuis plusieurs années, je vous propose ici mon avis sur le bundler esbuild.","tags":["webpack","js","bundler"]}}},{"node":{"excerpt":"Si vous avez besoin d’utiliser webpack pour votre projet. Vous êtes très souvent contraint par  qui a fait le travail pour vous. Vous ne…","fields":{"slug":"/fr/formation-webpack-gratuite/"},"timeToRead":1,"frontmatter":{"title":"Formation webpack gratuite et open-source","date":"July 23, 2019","dateJson":"2019-07-23","description":"webpack semble compliqué pour beaucou de monde. C’est pourquoi j'ai créé des ateliers pour apprendre ses concepts en partant de la base.","tags":["formation","webpack","débutant"]}}},{"node":{"excerpt":"Si vous utilisez webpack comme bundler pour votre application, vous êtes probablement préoccupé par ses propres performances et son temps de…","fields":{"slug":"/fr/pourquoi-vous-devriez-utiliser-le-compression-webpack-plugin/"},"timeToRead":3,"frontmatter":{"title":"Pourquoi devriez-vous utiliser le plugin Compression Webpack ?","date":"April 02, 2019","dateJson":"2019-04-02","description":"Si vous utilisez webpack comme bundler pour votre application, vous êtes probablement préoccupé par ses propres performances et son temps de chargement. Vous avez peut-être utilisé le code-splitting, le tree-shaking, l'uglification mais vous avez peut-être oublié une étape très importante.","tags":["webpack","compression"]}}}]}},"pageContext":{"slug":"/fr/vitejs-concurrent-performant-webpack-pour-react/","tags":["webpack","esbuild","vitejs","bundler"],"language":"fr","previous":{"fields":{"slug":"/fr/react-redux-pieges-bonnes-pratiques/"},"frontmatter":{"title":"React/Redux : pièges et meilleures pratiques","tags":["react","redux","web"]}},"next":{"fields":{"slug":"/fr/que-vaut-snowpack/"},"frontmatter":{"title":"🗻 Snowpack 🗻 le remplaçant de webpack ?️","tags":["webpack","snowpack","vitejs","bundler"]}}}},
    "staticQueryHashes": ["1264045386","1666466174","2564629789","4061151221","62118570"]}