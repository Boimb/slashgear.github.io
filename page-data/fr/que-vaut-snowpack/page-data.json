{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/fr/que-vaut-snowpack/",
    "result": {"data":{"site":{"siteMetadata":{"siteUrl":"https://slashgear.github.io"}},"config":{"html":"<p>Ecrit par <strong>Antoine Caron</strong> qui vit et travaille à Lyon et développe des choses utiles à <a href=\"https://www.bedrockstreaming.com/\">Bedrock</a>.\nTu devrais le suivre sur <a href=\"https://twitter.com/Slashgear_\">Twitter</a>.\nN’hésites pas à aller voir <a href=\"/conferences\">ses conférences sur la page dédiée</a>.\nSi vous voulez voir mon parcours pro, <a href=\"/resume\">mon CV est disponible ici en 🇬🇧</a>.</p>","fields":{"slug":"/fr/"},"frontmatter":{"title":"Antoine Caron","language":"fr"}},"markdownRemark":{"id":"4487894e-368c-547d-bb63-5a006be4f12b","excerpt":"Après webpack, esbuild et vitejs, prenons le temps d’étudier le cas de snowpack.\nCe dernier semble se faire un petit nom dans l’écosystème…","html":"<p>Après <a href=\"/fr/webpack\">webpack</a>, <a href=\"/fr/esbuild\">esbuild</a> et <a href=\"/fr/vitejs\">vitejs</a>, prenons le temps d’étudier le cas de <a href=\"/fr/snowpack\">snowpack</a>.\nCe dernier semble se faire un petit nom dans l’écosystème des bundlers depuis quelques années maintenant.\nJe vous propose donc qu’on étudie ses fonctionnalités, ses points forts mais également ses points faibles.</p>\n<h2 id=\"snowpack\" style=\"position:relative;\"><a href=\"#snowpack\" aria-label=\"snowpack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Snowpack</h2>\n<p>Snowpack c’est quoi ? C’est un packager d’application web qui propose :</p>\n<ul>\n<li>une expérience de développement riche et performante</li>\n<li>un mode <em>production</em> qui propose les features nécessaires à l’optimisation des assets du site.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># npm:</span>\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev snowpack\n<span class=\"token comment\"># yarn:</span>\n<span class=\"token function\">yarn</span> <span class=\"token function\">add</span> --dev snowpack</code></pre></div>\n<h3 id=\"esmodule-dans-le-navigateur\" style=\"position:relative;\"><a href=\"#esmodule-dans-le-navigateur\" aria-label=\"esmodule dans le navigateur permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ESModule dans le navigateur</h3>\n<p>Les packagers comme webpack et rollup se reposent sur la construction d’un arbre de dépendances qui sont analysées et packagées à chaque modification.\nL’étape de build des fichiers modifiés reste nécessaire, cependant l’opération de packaging (fusion des différents modules sous la forme de bundle qu’on envoie au navigateur) n’est plus nécessaire.\n<a href=\"https://caniuse.com/?search=esmodule\">Nos navigateurs savent maintenant gérer les ESModules</a>, il n’est donc plus nécessaire de packager nos modules sources pour les fusionner.</p>\n<blockquote>\n<p>C’est la même idée qu’Evan You a repris dans <a href=\"/fr/vitejs-concurrent-performant-webpack-pour-react\">Vite</a></p>\n</blockquote>\n<p>Avec ce principe, la modification d’un fichier ne déclenche que le build de ce fichier, et ce fichier uniquement.\nVous pourrez avoir un projet avec des milliers de modules javascript, le temps de build à chaque modification ne se retrouvera pas affecté.\nPour les dépendances (<em>vendors</em>), Snowpack les build une fois pour toutes et les mets en cache pour ne le refaire que si celles-ci ont changées.</p>\n<p>Voici un schéma présent dans la doc de Snowpack montrant bien l’intérêt d’éviter le packaging en dev.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b06ee5f06a63858b913ddade78afcaba/24def/snowpack-unbundled.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4ElEQVQoz62RX2/aQBDE8/2/Td8qRW0oqRSiAIEYY8dnY7ANFEMpYAdj359f5aNpX/PQlUa3OyeNZnduAIqiYLPZsN/vORUF56oi324tDocDho+VMYabttltc0QUsUgT1qsV+92OOIqIhCBLEmRdo1RDoxVN09jZck1jIesGJRsragWrquDbfMo4CZFCsHt6Ih8MWPZ67AdD9DxGrGI+uX1WkaB4HrHsPTDrdEi6XY6DIZfN+p/g29uR7sxlPA+oA0Hpumz6fdJej8JxUElCnGfczT3ydIEMAo6uS/b4yHY45OL5XPLVVdA0Z3TxA6qDJTTG4r2U1kilMErR0toYGqUsp4yxkFqjdfv/54bV5cLpdKIoS87nM2X5RlmWFnVd89Ey7yv/3G3xPZ94FpGmKWmS4LouvuexzTcYo+3RtW7f2rpuZ+teNjRS2tD+OiyKPQ+ZYLqa0csETiZ4zkIeF6+M0oBuNMFbRnxfeIwXHl/CCWIdczebME4CvoYOkzSwHq3gofjFZ++ZfujQCcY8RRMeIpf70KEfT+kEL0yXIbfekNHc59YfIdZzOqHDy+KV+3iKv4yugkZWqHJHfT5a+1e0KyiLdr728hpE+9eG8M7L2gZiWrQrGy0xdQnywv+o37AaQrjQnR65AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b06ee5f06a63858b913ddade78afcaba/f13a9/snowpack-unbundled.avif 200w,\n/static/b06ee5f06a63858b913ddade78afcaba/af71e/snowpack-unbundled.avif 400w,\n/static/b06ee5f06a63858b913ddade78afcaba/c9875/snowpack-unbundled.avif 800w,\n/static/b06ee5f06a63858b913ddade78afcaba/07e28/snowpack-unbundled.avif 1200w,\n/static/b06ee5f06a63858b913ddade78afcaba/2babf/snowpack-unbundled.avif 1600w,\n/static/b06ee5f06a63858b913ddade78afcaba/b2a15/snowpack-unbundled.avif 1812w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/avif\"\n            /><source\n              srcset=\"/static/b06ee5f06a63858b913ddade78afcaba/ba381/snowpack-unbundled.webp 200w,\n/static/b06ee5f06a63858b913ddade78afcaba/7f61c/snowpack-unbundled.webp 400w,\n/static/b06ee5f06a63858b913ddade78afcaba/d00b9/snowpack-unbundled.webp 800w,\n/static/b06ee5f06a63858b913ddade78afcaba/92f8c/snowpack-unbundled.webp 1200w,\n/static/b06ee5f06a63858b913ddade78afcaba/fad48/snowpack-unbundled.webp 1600w,\n/static/b06ee5f06a63858b913ddade78afcaba/e3ca4/snowpack-unbundled.webp 1812w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b06ee5f06a63858b913ddade78afcaba/772e8/snowpack-unbundled.png 200w,\n/static/b06ee5f06a63858b913ddade78afcaba/e17e5/snowpack-unbundled.png 400w,\n/static/b06ee5f06a63858b913ddade78afcaba/5a190/snowpack-unbundled.png 800w,\n/static/b06ee5f06a63858b913ddade78afcaba/c1b63/snowpack-unbundled.png 1200w,\n/static/b06ee5f06a63858b913ddade78afcaba/29007/snowpack-unbundled.png 1600w,\n/static/b06ee5f06a63858b913ddade78afcaba/24def/snowpack-unbundled.png 1812w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b06ee5f06a63858b913ddade78afcaba/5a190/snowpack-unbundled.png\"\n            alt=\"explication du mode de fonctionnement de snowpack qui se consentre sur le build uniquement\"\n            title=\"explication du mode de fonctionnement de snowpack qui se consentre sur le build uniquement\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Si vous utilisez un projet <em>Create React App</em>, il vous suffit d’ajouter Snowpack en dépendance, vous n’avez rien à changer si vous n’avez pas étendu la config de webpack.\nJe vous invite à tester snowpack grâce aux générateurs de templates:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npx create-snowpack-app react-snowpack --template @snowpack/app-template-react</code></pre></div>\n<p>Rassurez vous! Snowpack n’est pas compatible qu’avec React, vous pouvez utiliser Vue, Svelte ou bien juste du javascript.</p>\n<h3 id=\"une-config-riche-trop\" style=\"position:relative;\"><a href=\"#une-config-riche-trop\" aria-label=\"une config riche trop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Une config riche (trop)</h3>\n<p>À la manière de webpack, snowpack propose de configurer son utilisation par un objet.\nJe dois vous avouer qu’<a href=\"/fr/vitejs-concurrent-performant-webpack-pour-react/\">après avoir joué avec vite</a>, je suis un peu déçu.\nJe vois une maigre <a href=\"https://www.snowpack.dev/reference/configuration\">page de documentation</a> qui semble pourtant décrire de nombreuses clés paramètrables.</p>\n<p>Si vous venez de webpack, vous ne serez pas perdu, c’est très ressemblant sans pour autant être exactement la même chose.</p>\n<blockquote>\n<p>Eviter de toucher la configuration par défaut peut être une excellente idée.</p>\n</blockquote>\n<h3 id=\"une-belle-collection-de-plugin\" style=\"position:relative;\"><a href=\"#une-belle-collection-de-plugin\" aria-label=\"une belle collection de plugin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Une belle collection de plugin</h3>\n<p>Snowpack n’est pas si récent que ça.\nUne communauté a su se construire pour mettre en place <a href=\"https://www.snowpack.dev/plugins\">un écosystème de plugin riche</a>.\nCertains de ces plugins semblent “core” car sous le scope <em>@snowpack</em> mais de nombreux packages sont portés par quelques personnes indépendantes du projet.\nC’est rassurant sans l’être, j’ai personnellement connu des mises à jour de webpack bloquées/retardées en attendant la compatibilité de certains plugins qui n’étaient plus maintenus.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc98a59b3f3f71b4953ae1ed9d1f2503/fbf76/plugins.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.00000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEpklEQVRIx5WV224URxCG5w3zBHmP3EWKxD03cIFxJBK4QAoK4SJIAWzW+IgDtrX2Grw7e/Ae7J2dU0/P+fRF3eNdCAqJ0tKv6m711P5V9Vet0e12abVaTCYTjo6OuLi4YDgcou4HgwE909T7VxsbnJ6e6jv1ptczef/+Pefn57TbbUzTJI5jjPF4zNOnT3n27DdevPiDR48e8fDhz9y9c4e1e/dYW1vj+fPf2d7e5smTX7h16xaPHz/m8PCQnx48YP3+fdbX17l9+7Z2bPhhwuVCaIzmHtdexMjyMWcuU0cysQN9Hi8ChnOf3nTB1A4YXDl8vJwzsQXLVVUVRpwkOI6L5wsN1/XwRcDCdvB9H8/ztHVdV1tfvQlCFr5ERglFWWqUVUVV1xiWZencnHc6mnKn06HTOaN91qH9sc/ZhUl3OKbTHWh8MEe0zSkTyyMvSr5chpRyxURBMVFQbC3Hx3Z9LMfDFVIzEzLCF5IsTSmLHCFDnu+1+bV1xP5Zv3G4dLS0KgVChek4+J6HY9uEYUhd19RVpW1RFEDNwgv49ocf+ea7u3x//xmGSmRVldSoHFT6UZalWAuLhb1gbs1xXAdLW5vr+TVKGYqI+jYvCsI41flM8wJDJ7OqSeOCNPqEWGYkYd4gyomClCjIKIuaf1uGL2PGc5eL4zHHOz3O3g452elx9KbL6cGA83cj2vt9zg4HHL3pYV25RHFEEMgVVL7DKG6qXBQlcZoxnV3xsdvD7A/pmQPMwZAPF10Gw9HNXZ+uaTK6HPPhY5f+YIQQQSMj10PqHIOxpBonEWEkiWJJkkakWQwoWVTaqiJkWU5ZVlpzqjBfLpU6I80zojRldgXTGUymMJ7UDIc1k2nNdFYzuvz0sQpLOVO2KejnqDH8SHJpX3FyImhtzdnZtdnZddjddTh4q6zN/oGHbXskSaKd/hO75Y8ZyqsKQUYCVziI0COMBUHkkZcxFSmQ6xwlSdqwqz7DzXnJ2siLnDzPkW5G4KQIWyHBtxJ9VvfudYSW6L+spWMjCH1m1oiLkwkne11ODwe0D/oc73TpvBvSPjA52TOZjOb4QujKBrpdhYaUobbVTaGMsipRLP1A9ewCx3f13vEd4jQkTqQOXQQCzxON9pRDJRkhdCrUXVmWjcOirFDwBfg+iBvres0+isB1+c+1zO2qU94eCl63XDY2bTZfu7x8ZdPactjdc3jxcoHnRXoqOa6aSr4OXdksy5Yem6IooWZ5QSA9XN/B9WxE4CIChywLSVOFgDRNdGg6h4FchaoKumLYyKYRZSBrjTACGUIgIUlBEYhj0NPqa+E2BJu/AC3sxTWHf8a0tiSbrwONjU1Ja0uwsxvw8pXg+ETo9lRVXQ4FtQ/DiCiKdVvqXs6KnDCJmc2m9Ad9Rpcj3dMyFIRhoCGlwPWc1SDQ8Hxd6WU+4zjRTFfDQcnC8VwCGWgZFWXG/126ylmekmQJlgXX8wZqSIwnMJs156/Jpmm/T4Phb51ydCzY3rF4o7C90Ng/sNndW3B65iGEj+24Gs4NvhwSqyoXpZKNCtlpchV4eMLVXZJlEVkW64mspNIg0qhvRtkSiuFfb6JCFNlI7uAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dc98a59b3f3f71b4953ae1ed9d1f2503/f13a9/plugins.avif 200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/af71e/plugins.avif 400w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/c9875/plugins.avif 800w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/07e28/plugins.avif 1200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/ceb0a/plugins.avif 1252w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/avif\"\n            /><source\n              srcset=\"/static/dc98a59b3f3f71b4953ae1ed9d1f2503/ba381/plugins.webp 200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/7f61c/plugins.webp 400w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/d00b9/plugins.webp 800w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/92f8c/plugins.webp 1200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/5733b/plugins.webp 1252w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dc98a59b3f3f71b4953ae1ed9d1f2503/772e8/plugins.png 200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/e17e5/plugins.png 400w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/5a190/plugins.png 800w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/c1b63/plugins.png 1200w,\n/static/dc98a59b3f3f71b4953ae1ed9d1f2503/fbf76/plugins.png 1252w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dc98a59b3f3f71b4953ae1ed9d1f2503/5a190/plugins.png\"\n            alt=\"plugins list page screenshot\"\n            title=\"plugins list page screenshot\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<blockquote>\n<p>Méfiez-vous des plugins que vous utilisez!</p>\n</blockquote>\n<p>Contrairement à Vite qui propose nativement plein de fonctionnalités assez sympathiques, snowpack fonctionne lui comme webpack en se basant sur les plugins pour enrichir l’API.\nC’est un pari, il peut être compliqué de garder cet écosystème de plugin à jour et performant pour continuer de garantir l’intérêt d’une migration sur snowpack.</p>\n<h3 id=\"du-server-side-rendering\" style=\"position:relative;\"><a href=\"#du-server-side-rendering\" aria-label=\"du server side rendering permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Du Server Side Rendering</h3>\n<p>Snowpack propose une solution pour implémenter vos applications avec du server-side rendering.\nForce est de constater que le besoin du SSR se fait encore ressentir sur nos applications frontend pour des raisons SEO ou bien de performance de rendu.\nMalheureusement, coté packager d’application, cela reste encore compliqué et il reste souvent nécessaire de faire deux builds:</p>\n<ul>\n<li>un build pour le client aka le Navigateur</li>\n<li>un build pour le server Node</li>\n</ul>\n<blockquote>\n<p>Double build, double peine !</p>\n</blockquote>\n<p>La <a href=\"https://www.snowpack.dev/guides/server-side-render#option-3%3A-server-side-rendering-(ssr)\">technique proposée par Snowpack</a> reste limitée mais ça reste correct.\nJe vous propose une légère amélioration de l’implémentation en ajoutant les mécaniques de rendu server bufferisé.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>readFileSync<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>startServer<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'snowpack'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">startServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> runtime <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">getServerRuntime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> importedComponent <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> runtime<span class=\"token punctuation\">.</span><span class=\"token function\">importModule</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/dist/MyReactComponent.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> MyReactComponent <span class=\"token operator\">=</span> importedComponent<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToNodeStream</span><span class=\"token punctuation\">(</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>MyReactComponent<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Directly write the head of page</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;html>\n    &lt;head>\n      &lt;title>Hello 👋&lt;/title>\n    &lt;/head>\n    &lt;body>\n    &lt;div id=\"app\">\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// Render bufferized version of App</span>\n  html<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> end<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// When buffer end, we add the closing tags of page</span>\n  html<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      &lt;/div>\n      &lt;/body>\n      &lt;/html>\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"webpack-esbuild-vite-snowpack-on-part-sur-quoi-\" style=\"position:relative;\"><a href=\"#webpack-esbuild-vite-snowpack-on-part-sur-quoi-\" aria-label=\"webpack esbuild vite snowpack on part sur quoi  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Webpack, esbuild, vite, snowpack, on part sur quoi ?</h2>\n<p>Clairement après cette série d’article où j’ai essayé d’étudier cette nouvelle génération d’outils pour bundler les applications, je dois avouer que je suis très surpris.\nOn voit clairement que le support des ES Modules dans le navigateur marque l’entrée dans une nouvelle ère.\nComme le rappelle Sindre Sorhus dans <a href=\"https://blog.sindresorhus.com/hello-modules-d1010b4e777b\">son dernier article</a>, avec la fin du support de Node 10 et les capacitées de nos navigateurs actuels, il n’est maintenant plus nécessaire de cibler du CJS.</p>\n<p>Les stratégies de cache et l’usage des modules CJS semblent aujourd’hui bien dépassées pour nos besoins en environnement de développement.\nOn voit bien que Vite et Snowpack proposent cette nouvelle mécanique qui semble être vraiment performante.\nFaire un build <em>once for all</em> des librairies et de chaque fichier source est une super idée pour ne pas souffrir d’un temps de démarrage trop lent de nos grosses applications web.</p>\n<blockquote>\n<p>Gardons à l’oeil Esbuild</p>\n</blockquote>\n<p>Cependant, la performance de ces nouveaux outils repose aussi essentiellement sur Esbuild.\nL’idée d’utiliser une stack plus optimisée pour lire, parser, combiner des modules JS ou TS avec des langages qui permettent une gestion IO et mémoire plus fine est vraiment la clé de voute de cette nouvelle génération d’outils.\nAvant même de choisir s’il faut rester sur webpack, ou utiliser Vite et Snowpack, il est certain qu’il faudra suivre de près Esbuild.\nCette lib n’a pas fini de nous surprendre.\nIl faut également s’intéresser à un outil comme <a href=\"https://swc.rs/\">SWC</a> qui est un concurrent direct d’Esbuild.\nIl y a certainement d’autres outils en cours de création dans le même genre.</p>\n<h3 id=\"jutilise-webpack-et-je-lai-beaucoup-configuré\" style=\"position:relative;\"><a href=\"#jutilise-webpack-et-je-lai-beaucoup-configur%C3%A9\" aria-label=\"jutilise webpack et je lai beaucoup configuré permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>J’utilise webpack et je l’ai beaucoup configuré</h3>\n<p>Si vous êtes dans cette situation, vous pouvez malheureusement être contraint de conserver webpack.\nCe n’est pas une mauvaise nouvelle, c’est un très bon outil qui est loin d’être obsolète.\nIl y a fort à parier que la team de webpack va nous proposer encore de nouvelles améliorations de performances qui passeront peut-être par l’usage des ESModules.</p>\n<p>Vous pouvez également tenter d’utiliser snowpack en environnement de développement.\nIl existe d’ailleurs <a href=\"https://www.npmjs.com/package/@snowpack/plugin-webpack\">un plugin pour utiliser webpack dans le build de prod de snowpack</a>.</p>\n<h3 id=\"je-souhaite-vraiment-réduire-la-configuration-du-build-de-mon-application\" style=\"position:relative;\"><a href=\"#je-souhaite-vraiment-r%C3%A9duire-la-configuration-du-build-de-mon-application\" aria-label=\"je souhaite vraiment réduire la configuration du build de mon application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Je souhaite vraiment réduire la configuration du build de mon application</h3>\n<p>Si vous ne souhaitez plus conserver vos fichiers de configuration webpack qui peuvent être parfois difficilement maintenable, l’alternative proposée par Vite peut être une super option.\nGardez seulement à l’esprit que cette solution reste jeune.</p>\n<p>Quitte à utiliser Vite, je vous conseille de minimiser la configuration que vous pourriez lui apporter.\nCela vous permettra plus facilement de suivre les nouvelles versions qui risquent d’arriver dans les mois qui viennent.</p>\n<h3 id=\"jutilise-un-cli-qui-gère-ma-configuration-de-build-pour-moi\" style=\"position:relative;\"><a href=\"#jutilise-un-cli-qui-g%C3%A8re-ma-configuration-de-build-pour-moi\" aria-label=\"jutilise un cli qui gère ma configuration de build pour moi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>J’utilise un CLI qui gère ma configuration de build pour moi</h3>\n<p>Vous utilisez VueCLI, CRA, ou autre et vous n’avez pas éjecté votre configuration.\nVous n’aimez pas trop toucher à la configuration de build de votre application car les outils sont complexes et vous ne souhaitez pas passer un temps monstre à les configurer.\nJe vous recommande donc de rester un maximum avec la configuration par défaut de votre projet tant que les performances de celle-ci ne vous gènent pas.</p>\n<p>Cependant, rien ne vous interdit de tester les outils comme Vite qui marchent directement sans configuration avec vos projets déjà générés.\nSi le temps de démarrage de votre environnement de développement devient trop important, cela peut vraiment être une solution intéressante pour vous.</p>\n<h2 id=\"et-cest-déjà-la-fin-\" style=\"position:relative;\"><a href=\"#et-cest-d%C3%A9j%C3%A0-la-fin-\" aria-label=\"et cest déjà la fin  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Et c’est déjà la fin ?</h2>\n<p>Je pense avoir fait le tour des nouveaux outils proposés par la communauté pour packager nos applications web.\nSi vous avez d’autres outils qu’il serait intéressant d’examiner, n’hésitez pas à me le proposer sur un réseau social comme Twitter.\nÀ bientôt pour de nouvelles <em>pérégrinations javascriptesques</em> !👋</p>\n<p>Merci à Jérémie pour la review 🤗</p>","headings":[{"value":"Snowpack"},{"value":"ESModule dans le navigateur"},{"value":"Une config riche (trop)"},{"value":"Une belle collection de plugin"},{"value":"Du Server Side Rendering"},{"value":"Webpack, esbuild, vite, snowpack, on part sur quoi ?"},{"value":"J’utilise webpack et je l’ai beaucoup configuré"},{"value":"Je souhaite vraiment réduire la configuration du build de mon application"},{"value":"J’utilise un CLI qui gère ma configuration de build pour moi"},{"value":"Et c’est déjà la fin ?"}],"wordCount":{"words":1255},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#snowpack\">Snowpack</a></p>\n<ul>\n<li><a href=\"#esmodule-dans-le-navigateur\">ESModule dans le navigateur</a></li>\n<li><a href=\"#une-config-riche-trop\">Une config riche (trop)</a></li>\n<li><a href=\"#une-belle-collection-de-plugin\">Une belle collection de plugin</a></li>\n<li><a href=\"#du-server-side-rendering\">Du Server Side Rendering</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#webpack-esbuild-vite-snowpack-on-part-sur-quoi-\">Webpack, esbuild, vite, snowpack, on part sur quoi ?</a></p>\n<ul>\n<li><a href=\"#jutilise-webpack-et-je-lai-beaucoup-configur%C3%A9\">J’utilise webpack et je l’ai beaucoup configuré</a></li>\n<li><a href=\"#je-souhaite-vraiment-r%C3%A9duire-la-configuration-du-build-de-mon-application\">Je souhaite vraiment réduire la configuration du build de mon application</a></li>\n<li><a href=\"#jutilise-un-cli-qui-g%C3%A8re-ma-configuration-de-build-pour-moi\">J’utilise un CLI qui gère ma configuration de build pour moi</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#et-cest-d%C3%A9j%C3%A0-la-fin-\">Et c’est déjà la fin ?</a></p>\n</li>\n</ul>","frontmatter":{"title":"🗻 Snowpack 🗻 le remplaçant de webpack ?️","date":"June 02, 2021","dateJson":"2021-06-02","translations":["en","should-snowpack-replace-webpack"],"description":"Après des articles sur esbuild, vite, je vous propose de découvrir ensemble snowpack afin de se faire un avis.","language":"fr","tags":["webpack","snowpack","vitejs","bundler"],"hero":{"childImageSharp":{"fluid":{"aspectRatio":1.9083969465648856,"src":"/static/f90d055f17d9519a65b2c2f1694cfa1a/a7715/social-2.jpg","srcSet":"/static/f90d055f17d9519a65b2c2f1694cfa1a/8f7df/social-2.jpg 250w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/0f3a1/social-2.jpg 500w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/a7715/social-2.jpg 1000w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/37d86/social-2.jpg 1500w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/a41d1/social-2.jpg 2000w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/f79d2/social-2.jpg 4400w","srcWebp":"/static/f90d055f17d9519a65b2c2f1694cfa1a/e30b5/social-2.webp","srcSetWebp":"/static/f90d055f17d9519a65b2c2f1694cfa1a/7ca0e/social-2.webp 250w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/e9589/social-2.webp 500w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/e30b5/social-2.webp 1000w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/90fb1/social-2.webp 1500w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/37117/social-2.webp 2000w,\n/static/f90d055f17d9519a65b2c2f1694cfa1a/96530/social-2.webp 4400w","sizes":"(max-width: 1000px) 100vw, 1000px"},"image":{"src":"/static/f90d055f17d9519a65b2c2f1694cfa1a/10d63/social-2.jpg"},"image16x9":{"src":"/static/f90d055f17d9519a65b2c2f1694cfa1a/6edcc/social-2.jpg"},"image4x3":{"src":"/static/f90d055f17d9519a65b2c2f1694cfa1a/e14ae/social-2.jpg"},"image1x1":{"src":"/static/f90d055f17d9519a65b2c2f1694cfa1a/db124/social-2.jpg"}}}}},"relatedPosts":{"edges":[{"node":{"excerpt":"Après avoir traité sur ce blog dans plusieurs articles de webpack, j’ai commencé une nouvelle série d’articles sur les bundlers nouvelles…","fields":{"slug":"/fr/vitejs-concurrent-performant-webpack-pour-react/"},"timeToRead":9,"frontmatter":{"title":"Vite, le remplaçant à webpack ?!😮","date":"March 26, 2021","dateJson":"2021-03-26","description":"Après avoir étudié des solutions comme Webpack et Esbuild, il me fallait m'intéresser aux outils comme Vite qui fait partie à mes yeux d'une nouvelle génération.","tags":["webpack","esbuild","vitejs","bundler"]}}},{"node":{"excerpt":"Cela fait plusieurs années que je joue avec les bundlers JS.\nRestant convaincu de la nécessité de l’usage de ces outils (ne me laissez pas…","fields":{"slug":"/fr/esbuild-bundler-incroyablement-rapide-et-prometteur/"},"timeToRead":6,"frontmatter":{"title":"Esbuild, le bundler incroyablement rapide 💨 et prometteur 📈 !","date":"March 14, 2021","dateJson":"2021-03-14","description":"Jouant avec les bundler traditionnels comme webpack depuis plusieurs années, je vous propose ici mon avis sur le bundler esbuild.","tags":["webpack","js","bundler"]}}},{"node":{"excerpt":"Si vous avez besoin d’utiliser webpack pour votre projet. Vous êtes très souvent contraint par  qui a fait le travail pour vous. Vous ne…","fields":{"slug":"/fr/formation-webpack-gratuite/"},"timeToRead":1,"frontmatter":{"title":"Formation webpack gratuite et open-source","date":"July 23, 2019","dateJson":"2019-07-23","description":"webpack semble compliqué pour beaucou de monde. C’est pourquoi j'ai créé des ateliers pour apprendre ses concepts en partant de la base.","tags":["formation","webpack","débutant"]}}},{"node":{"excerpt":"Si vous utilisez webpack comme bundler pour votre application, vous êtes probablement préoccupé par ses propres performances et son temps de…","fields":{"slug":"/fr/pourquoi-vous-devriez-utiliser-le-compression-webpack-plugin/"},"timeToRead":3,"frontmatter":{"title":"Pourquoi devriez-vous utiliser le plugin Compression Webpack ?","date":"April 02, 2019","dateJson":"2019-04-02","description":"Si vous utilisez webpack comme bundler pour votre application, vous êtes probablement préoccupé par ses propres performances et son temps de chargement. Vous avez peut-être utilisé le code-splitting, le tree-shaking, l'uglification mais vous avez peut-être oublié une étape très importante.","tags":["webpack","compression"]}}}]}},"pageContext":{"slug":"/fr/que-vaut-snowpack/","tags":["webpack","snowpack","vitejs","bundler"],"language":"fr","previous":{"fields":{"slug":"/fr/vitejs-concurrent-performant-webpack-pour-react/"},"frontmatter":{"title":"Vite, le remplaçant à webpack ?!😮","tags":["webpack","esbuild","vitejs","bundler"]}},"next":{"fields":{"slug":"/fr/comment-mettre-en-place-des-tests-bout-en-bout-avec-webdriverio/"},"frontmatter":{"title":"Comment mettre en place des tests bout en bout avec WebdriverIo ?","tags":["github","action","e2e","WebdriverIo"]}}}},
    "staticQueryHashes": ["1264045386","1666466174","2564629789","4061151221","62118570"]}