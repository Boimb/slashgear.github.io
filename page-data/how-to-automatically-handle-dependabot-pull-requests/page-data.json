{"componentChunkName":"component---src-templates-blog-post-js","path":"/how-to-automatically-handle-dependabot-pull-requests/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.slashgear.dev"}},"config":{"html":"<p>Written by <strong>Antoine Caron</strong> who lives and works in Lyon (France) building useful things at <a href=\"https://www.bedrockstreaming.com/\">Bedrock</a>.\nYou should follow him <a href=\"https://twitter.com/Slashgear_\">on Twitter</a>.\nTake a look at <a href=\"/friends-you-should-follow\">my friends websites</a>.\nYou could also <a href=\"/conferences\">take a look at the conferences I gave</a>.\nIf you want to see my professional background, <a href=\"/resume\">my resume is available here</a>.</p>","fields":{"slug":"/"},"frontmatter":{"title":"Antoine Caron","language":"en"}},"markdownRemark":{"id":"725e0451-dfcd-5f7d-bb32-604d42d0db1c","excerpt":"Recently, I‚Äôve been working a lot on industrializing this blog (maybe even a little too much).\nThis blog is my playground, I experiment, I‚Ä¶","html":"<p>Recently, I‚Äôve been working a lot on industrializing this blog <em>(maybe even a little too much)</em>.\nThis blog is my playground, I experiment, I play, I test things.\nI admit that it‚Äôs over-engineered but I‚Äôm having a lot of fun with it. üòÖ</p>\n<p>Since its release, I tried to use <a href=\"https://docs.github.com/en/code-security/dependabot\">dependabot</a> from github on my repositories.\nAt the beginning without much conviction.\nAs much as I thought it was great in principle, the noise generated by the dozens of open PRs per day was really annoying.\nAs a maintainer of various open-source projects, I have been victim of dependabot PR flood several times. <em>A real nightmare</em>.</p>\n<p>I had foolishly made no effort to configure it.\nRecently, I thought I should give it another chance.\nSo I set up <a href=\"https://github.com/Slashgear/slashgear.github.io/blob/72f2575bcc4c9eedf4c61a7cf734e54eceee1241/.github/dependabot.yml\">this configuration that allowed me to update my JS dependencies and used github actions</a> in my workflows.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\n<span class=\"token key atrule\">updates</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">package-ecosystem</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'npm'</span> <span class=\"token comment\"># See documentation for possible values</span>\n    <span class=\"token key atrule\">directory</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span> <span class=\"token comment\"># Location of package manifests</span>\n    <span class=\"token key atrule\">open-pull-requests-limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">25</span>\n    <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'daily'</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">package-ecosystem</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'github-actions'</span> <span class=\"token comment\"># See documentation for possible values</span>\n    <span class=\"token key atrule\">directory</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/'</span> <span class=\"token comment\"># Location of package manifests</span>\n    <span class=\"token key atrule\">open-pull-requests-limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">25</span>\n    <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'daily'</span></code></pre></div>\n<p>No lie, with this configuration, on this blog developed with Gatsby, <a href=\"https://docs.github.com/en/code-security/dependabot\">Dependabot</a> was opening up to 20 Pull Requests per week.</p>\n<h2 id=\"Ô∏è-limits\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-limits\" aria-label=\"Ô∏è limits permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>‚ö†Ô∏è Limits</h2>\n<p>At the beginning, when you see all the PRs opening with all the dependencies updates, you are quite happy.\nHowever, managing this every week is really time consuming.\nMoreover, when we merge these PRs in a chain, we generate in cascade conflicts on the <code class=\"language-text\">package.json</code> file which prevents the merge üòí.\nIt is therefore often necessary to wait for dependabot to rebase the PR by itself, for the tests to pass and then wait for the Pull Request to merge.</p>\n<p><img src=\"/8483cc022eacd31176dd8f0659c3d658/click.gif\" alt=\"Animation of a hand clicking frantically\"></p>\n<h2 id=\"Ô∏è-lets-merge-it-automatically\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-lets-merge-it-automatically\" aria-label=\"Ô∏è lets merge it automatically permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>‚ôªÔ∏è Let‚Äôs merge it automatically!</h2>\n<p>Having set up E2E tests on this blog, the check ‚úÖ given by my continuous integration workflow is very reassuring.\n<a href=\"/how-to-setup-e2e-tests-with-webdriverio/\">You can have a look at this article which describes how I set up these tests</a></p>\n<p>With this automation, I‚Äôm pretty serene when I merge the dependabot update PR.\nSo I thought, <em>‚ÄúWhy not automatically merge the PRs that pass the E2E tests?‚Äù</em></p>\n<p>To do this, in my continuous integration workflow, I just had to add a new job configured this way.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"> <span class=\"token key atrule\">dependabot</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Dependabot'</span>\n    <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>build<span class=\"token punctuation\">,</span> e2e<span class=\"token punctuation\">]</span> <span class=\"token comment\"># After the E2E and build jobs, if one of them fails, it won't merge the PR.</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.actor == 'dependabot<span class=\"token punctuation\">[</span>bot<span class=\"token punctuation\">]</span>' <span class=\"token important\">&amp;&amp;</span> github.event_name == 'pull_request'<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token comment\"># Detect that the PR author is dependabot</span>\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Enable auto<span class=\"token punctuation\">-</span>merge for Dependabot PRs\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> gh pr merge <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>auto <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>merge \"$PR_URL\" <span class=\"token comment\"># Use Github CLI to merge automatically the PR</span>\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">PR_URL</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>github.event.pull_request.html_url<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>secrets.GITHUB_TOKEN<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://github.com/Slashgear/slashgear.github.io/blob/72f2575bcc4c9eedf4c61a7cf734e54eceee1241/.github/workflows/continuous-integration.yml\">If you want to see the real example, take a look at this blog workflow.</a></p>\n<h2 id=\"-in-the-end-is-it-really-safer\" style=\"position:relative;\"><a href=\"#-in-the-end-is-it-really-safer\" aria-label=\" in the end is it really safer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>üëÆ‚Äç In the end, is it really safer?</h2>\n<p>SWithout explaining what <a href=\"https://docs.github.com/en/code-security/dependabot\">dependabot</a> is, one could think that all this could bring more security.\nIndeed, as soon as security patches are available, they would be automatically applied and deployed on my blog without any manual manipulation being necessary.</p>\n<p>My availability to merge the PRs of dependabot being limited, one could say that setting up automation improves things.\nA good E2E testing strategy ensuring that I don‚Äôt break anything too important on my site seems really convenient.</p>\n<p>But in the end, who controls the updates and what they contain?\nWho makes sure that they don‚Äôt contain malicious code?\nThis blog is not a sandbox for me, so it‚Äôs not very problematic.\nSo think carefully before setting it up.</p>","headings":[{"value":"‚ö†Ô∏è Limits"},{"value":"‚ôªÔ∏è Let‚Äôs merge it automatically!"},{"value":"üëÆ‚Äç In the end, is it really safer?"}],"wordCount":{"words":477},"tableOfContents":"<ul>\n<li><a href=\"#%EF%B8%8F-limits\">‚ö†Ô∏è Limits</a></li>\n<li><a href=\"#%EF%B8%8F-lets-merge-it-automatically\">‚ôªÔ∏è Let‚Äôs merge it automatically!</a></li>\n<li><a href=\"#-in-the-end-is-it-really-safer\">üëÆ‚Äç In the end, is it really safer?</a></li>\n</ul>","frontmatter":{"title":"How to automatically merge dependabot pull requests with Github Actions ?","date":"May 10, 2022","dateJson":"2022-05-10","translations":null,"description":"Example with this blog implementation where dependabot PR automatically merge on default branch if e2e tests pass.","language":"en","tags":["tutorial","github","gatsby","action","dependabot"],"hero":{"childImageSharp":{"fluid":{"aspectRatio":1.5,"src":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/4fe8c/markus-winkler-cxoR55-bels-unsplash.jpg","srcSet":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/aabdf/markus-winkler-cxoR55-bels-unsplash.jpg 150w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/9dc27/markus-winkler-cxoR55-bels-unsplash.jpg 300w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/4fe8c/markus-winkler-cxoR55-bels-unsplash.jpg 600w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/9842e/markus-winkler-cxoR55-bels-unsplash.jpg 900w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/47498/markus-winkler-cxoR55-bels-unsplash.jpg 1200w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/be7fd/markus-winkler-cxoR55-bels-unsplash.jpg 3999w","srcWebp":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/ad85c/markus-winkler-cxoR55-bels-unsplash.webp","srcSetWebp":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/e7487/markus-winkler-cxoR55-bels-unsplash.webp 150w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/403a4/markus-winkler-cxoR55-bels-unsplash.webp 300w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/ad85c/markus-winkler-cxoR55-bels-unsplash.webp 600w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/210c1/markus-winkler-cxoR55-bels-unsplash.webp 900w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/99238/markus-winkler-cxoR55-bels-unsplash.webp 1200w,\n/static/fb64d3b2fb71b3d739ad5c13a93e12c5/15103/markus-winkler-cxoR55-bels-unsplash.webp 3999w","sizes":"(max-width: 600px) 100vw, 600px"},"image":{"src":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/10d63/markus-winkler-cxoR55-bels-unsplash.jpg"},"image16x9":{"src":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/6edcc/markus-winkler-cxoR55-bels-unsplash.jpg"},"image4x3":{"src":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/e14ae/markus-winkler-cxoR55-bels-unsplash.jpg"},"image1x1":{"src":"/static/fb64d3b2fb71b3d739ad5c13a93e12c5/db124/markus-winkler-cxoR55-bels-unsplash.jpg"}}}}},"relatedPosts":{"edges":[{"node":{"excerpt":"Like last year, I am taking part in the advent of code 2021.\nAll my solution are opensource and free to reuse.\nI am doing it in Javascript‚Ä¶","fields":{"slug":"/advent-of-code-2021/"},"timeToRead":1,"frontmatter":{"title":"üéÑ Advent of Code 2021 üéÑ: my solutions with JS","date":"December 04, 2021","dateJson":"2021-12-04","description":null,"tags":["javascript","oss","github","adventOfCode"]}}},{"node":{"excerpt":"I recently set up an end-to-end testing stack to make sure I wasn‚Äôt going to introduce any functional regressions to my blog.\nWith several‚Ä¶","fields":{"slug":"/how-to-setup-e2e-tests-with-webdriverio/"},"timeToRead":8,"frontmatter":{"title":"How to setup end to end tests with WebdriverIo on Github action ?","date":"August 13, 2021","dateJson":"2021-08-13","description":"For some time now I've been playing with github actions to see if I can easily reproduce behaviors I apply in my current CI tool. I wanted to parallelize tasks on each label of a pull request.","tags":["github","action","e2e","WebdriverIo"]}}},{"node":{"excerpt":"I decided this year to try the adventofcode2020 challenge in JS to see.\nI published the solutions I found in a public repository on Github‚Ä¶","fields":{"slug":"/advent-of-code-2020/"},"timeToRead":1,"frontmatter":{"title":"üéÑ Advent of Code 2020 üéÑ: my solutions with JS","date":"December 04, 2020","dateJson":"2020-12-04","description":"I decided this year to try the adventofcode2020 challenge in JS to see. I published the solutions I found in a public repository on Github.","tags":["javascript","oss","github","adventOfCode"]}}},{"node":{"excerpt":"Once again, I gave myself a challenge to learn how to use Github Action.\nI tried to see if it was possible to dynamically launch a job for‚Ä¶","fields":{"slug":"/how-to-split-test-by-folder-with-github-action/"},"timeToRead":1,"frontmatter":{"title":"Github Action: How to parallelize tests dynamically by folder?","date":"December 01, 2020","dateJson":"2020-12-01","description":"Once again, I play with Github Action to see if it can answer the CI problems I may encounter in my work.","tags":["github","action","CI","tutorial"]}}}]}},"pageContext":{"slug":"/how-to-automatically-handle-dependabot-pull-requests/","tags":["tutorial","github","gatsby","action","dependabot"],"language":"en","previous":{"fields":{"slug":"/conference-i-recommend/"},"frontmatter":{"title":"The conferences I recommend to my students üéì","tags":["conference","student","teach"]}},"next":null}},"staticQueryHashes":["1264045386","1666466174","2564629789","4061151221","62118570"]}