<!DOCTYPE html><html lang="fr" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Montserrat','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Montserrat','Georgia',serif;font-weight:500;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Montserrat','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);color:inherit;border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:500;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:1.75rem;color:var(--header);}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><style data-href="/styles.4184ee054a53e046837c.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}body{--bg-transition:background-color 0.5s ease;background-color:var(--bg);transition:var(--bg-transition)}body.light-mode{--bg:#fff;--bg-secondary:#f9fafb;--header:#7e40c4;--textNormal:#222;--textTitle:#222;--textLink:#7e40c4;--hr:rgba(0,0,0,0.2);--inlineCode-bg:rgba(255,229,100,0.2);--inlineCode-text:#1a1a1a;--form-shadow:0 2px 15px 0 rgba(210,214,220,0.5)}body.dark-mode{-webkit-font-smoothing:antialiased;--bg:#272b34;--bg-secondary:#363c48;--header:#b675ff;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#fff;--textLink:#b675ff;--hr:hsla(0,0%,100%,0.2);--inlineCode-bg:rgba(115,124,153,0.2);--inlineCode-text:#e6e6e6;--form-shadow:0 2px 15px 0 rgba(26,26,27,0.637)}@media print{body.dark-mode{--bg:#fff;--bg-secondary:#f9fafb;--header:#7e40c4;--textNormal:#222;--textTitle:#222;--textLink:#7e40c4;--hr:rgba(0,0,0,0.2);--inlineCode-bg:rgba(255,229,100,0.2);--inlineCode-text:#1a1a1a;--form-shadow:0 2px 15px 0 rgba(210,214,220,0.5)}}</style><meta name="generator" content="Gatsby 4.2.0"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Your Site&#x27;s RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=6d4845a20dbe813a1019a37775ca875f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="darkgrey"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=6d4845a20dbe813a1019a37775ca875f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=6d4845a20dbe813a1019a37775ca875f"/><title data-react-helmet="true">React/Redux : pièges et meilleures pratiques | Antoine Caron</title><link data-react-helmet="true" rel="alternate" hreflang="en" href="/react-redux-pitfalls-and-best-pratices"/><link data-react-helmet="true" rel="alternate" hreflang="fr" href="/fr/react-redux-pieges-bonnes-pratiques/"/><meta data-react-helmet="true" property="og:locale:alternate" content="en_US"/><meta data-react-helmet="true" property="og:site_name" content="Antoine Caron"/><meta data-react-helmet="true" name="description" content="Nous utilisons React et Redux depuis presque 4 ans chez Bedrock sur notre plateforme vidéo nommée 6play. Les bonnes pratiques et les erreurs à éviter ont été rassemblées dans cet article. react, redux, web"/><meta data-react-helmet="true" property="og:url" content="https://blog.slashgear.dev/fr/react-redux-pieges-bonnes-pratiques/"/><meta data-react-helmet="true" property="og:title" content="React/Redux : pièges et meilleures pratiques"/><meta data-react-helmet="true" property="og:description" content="Nous utilisons React et Redux depuis presque 4 ans chez Bedrock sur notre plateforme vidéo nommée 6play. Les bonnes pratiques et les erreurs à éviter ont été rassemblées dans cet article. react, redux, web"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:locale" content="fr_FR"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="Slashgear_"/><meta data-react-helmet="true" name="twitter:title" content="React/Redux : pièges et meilleures pratiques"/><meta data-react-helmet="true" name="twitter:description" content="Nous utilisons React et Redux depuis presque 4 ans chez Bedrock sur notre plateforme vidéo nommée 6play. Les bonnes pratiques et les erreurs à éviter ont été rassemblées dans cet article. react, redux, web"/><meta data-react-helmet="true" property="og:image" content="https://blog.slashgear.dev/static/ee72c19029938b25ca14c9387d5095ab/10d63/redux.jpg"/><meta data-react-helmet="true" name="twitter:image" content="https://blog.slashgear.dev/static/ee72c19029938b25ca14c9387d5095ab/10d63/redux.jpg"/><meta data-react-helmet="true" property="og:image:alt" content="React/Redux : pièges et meilleures pratiques"/><meta data-react-helmet="true" property="og:image:width" content="1080"/><meta data-react-helmet="true" property="og:image:type" content="image/jpeg"/><meta data-react-helmet="true" property="article:author" content="Antoine Caron"/><meta data-react-helmet="true" property="article:section" content="Frontend Tech"/><meta data-react-helmet="true" property="article:tag" content="react"/><meta data-react-helmet="true" property="article:tag" content="redux"/><meta data-react-helmet="true" property="article:tag" content="web"/><meta data-react-helmet="true" property="article:published_time" content="2021-03-23"/><meta data-react-helmet="true" name="keywords" content="react,redux,web"/><meta data-react-helmet="true" name="google-site-verification" content="h1uQ_z8fdlLI60AmxP8vjy1H-bKSDlv0n5XolWfeDIo"/><meta data-react-helmet="true" property="fb:app_id" content="235346886871248"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style data-styled="" data-styled-version="5.3.3">.jzTCVn{min-height:150px;margin-bottom:2.5rem;}/*!sc*/
.jzTCVn * > div{margin-left:0.5rem;}/*!sc*/
data-styled.g1[id="biocomponent__Wrapper-sc-1oo1jyu-0"]{content:"jzTCVn,"}/*!sc*/
.huLTfH{float:left;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;border-radius:50%;box-shadow:2px 4px 8px hsl(0deg 0% 0% / 0.25);}/*!sc*/
data-styled.g2[id="biocomponent__Image-sc-1oo1jyu-1"]{content:"huLTfH,"}/*!sc*/
.bOzXxU{margin-left:auto;margin-right:auto;color:var(--textNormal);background:var(--bg);-webkit-transition:var(--bg-transition);transition:var(--bg-transition);max-width:1000px;padding:2.625rem 1.3125rem;}/*!sc*/
data-styled.g3[id="maxWidthWrapper__MaxWidthWrapper-sc-1wy8f9q-0"]{content:"bOzXxU,"}/*!sc*/
.erDhjp{--switch-height:2.5em;--switch-padding:0.25em;--switch-button-size:calc(var(--switch-height) - 2 * var(--switch-padding));--standard-easing:cubic-bezier(0.4,0,0.2,1);color:var(--font-color);width:calc(2 * var(--switch-button-size) + 2 * var(--switch-padding));height:var(--switch-height);background:var(--switch-background-color);box-shadow:var(--switch-shadow);position:relative;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;border-radius:calc(var(--switch-height) / 2);-webkit-transition:background 150ms var(--standard-easing);transition:background 150ms var(--standard-easing);--primary-300:#93c5fd;--grey-50:#f8fafc;--grey-100:#f1f5f9;--grey-300:#cbd5e1;--grey-400:#94a3b8;--grey-500:#64748b;--grey-600:#475569;}/*!sc*/
.light-mode .switchercomponent__Switcher-sc-mlsxp7-0{--font-color:var(--grey-600);--icon-inactive-color:var(--grey-400);--switch-background-color:hsla(268,100%,73%,0.2);--switch-shadow:inset 0px 0px 0.125em rgba(0,0,0,0.06),inset 0px 0px 0.0625em rgba(0,0,0,0.04);--switch-button-shadow:0px 0px 0.125em rgba(0,0,0,0.06),0px 0px 0.0625em rgba(0,0,0,0.04);}/*!sc*/
.dark-mode .switchercomponent__Switcher-sc-mlsxp7-0{--font-color:var(--grey-50);--icon-inactive-color:var(--grey-300);--switch-background-color:hsla(268,100%,73%,0.7);--switch-shadow:inset 0px 0px 0.125em rgba(0,0,0,0.16),inset 0px 0px 0.0625em rgba(0,0,0,0.24);--switch-button-shadow:0px 0px 0.125em rgba(0,0,0,0.16),0px 0px 0.0625em rgba(0,0,0,0.14);}/*!sc*/
data-styled.g4[id="switchercomponent__Switcher-sc-mlsxp7-0"]{content:"erDhjp,"}/*!sc*/
.fqEccz{width:var(--switch-button-size);height:var(--switch-button-size);background:var(--bg);border-radius:50%;box-shadow:var(--switch-button-shadow);position:absolute;pointer-events:none;left:var(--switch-padding);top:calc(50% - var(--switch-button-size) / 2);-webkit-transition:left 150ms var(--standard-easing),background 100ms;transition:left 150ms var(--standard-easing),background 100ms;}/*!sc*/
.dark-mode .buttoncomponent__Button-sc-t9bezb-0{left:calc(var(--switch-padding) + var(--switch-button-size));}/*!sc*/
data-styled.g5[id="buttoncomponent__Button-sc-t9bezb-0"]{content:"fqEccz,"}/*!sc*/
.LNFxg{opacity:0;width:0;height:0;position:absolute;}/*!sc*/
.LNFxg:focus-visible ~ .buttoncomponent__Button-sc-t9bezb-0{box-shadow:0 0 0 3px var(--primary-300);}/*!sc*/
.LNFxg:focus ~ .buttoncomponent__Button-sc-t9bezb-0{box-shadow:0 0 0 3px var(--primary-300);}/*!sc*/
.LNFxg:focus:not(:focus-visible) ~ .buttoncomponent__Button-sc-t9bezb-0{box-shadow:var(--switch-button-shadow);}/*!sc*/
.LNFxg:checked ~ svg{color:var(--font-color);}/*!sc*/
.LNFxg[value='light'] ~ svg{max-width:calc(0.7 * var(--switch-button-size));max-height:calc(0.7 * var(--switch-button-size));}/*!sc*/
.LNFxg[value='light'] ~ svg > #sun-rays{-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;}/*!sc*/
.LNFxg[value='light']:not(:checked) ~ svg > #sun-rays{-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;stroke-width:0.5;}/*!sc*/
.LNFxg[value='light']:checked ~ svg,.LNFxg[value='auto']:checked ~ svg{color:#facc15;}/*!sc*/
.LNFxg[value='dark'] ~ svg > .star{-webkit-transform-origin:bottom;-ms-transform-origin:bottom;transform-origin:bottom;}/*!sc*/
.LNFxg[value='dark']:not(:checked) ~ svg > .star{-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);opacity:0;}/*!sc*/
.LNFxg:not(:checked) + .buttoncomponent__Button-sc-t9bezb-0{visibility:hidden;}/*!sc*/
.LNFxg:not(:checked) + .buttoncomponent__Button-sc-t9bezb-0:hover{visibility:visible;opacity:0.2;}/*!sc*/
data-styled.g6[id="inputcomponent__Input-sc-1s3keza-0"]{content:"LNFxg,"}/*!sc*/
.IjnPv{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex:1;-ms-flex:1;flex:1;cursor:pointer;-webkit-transition:background 100ms;transition:background 100ms;}/*!sc*/
.IjnPv::before{content:'';position:absolute;width:var(--switch-button-size);height:var(--switch-button-size);background:var(--font-color);opacity:0;border-radius:50%;-webkit-transition:opacity 100ms;transition:opacity 100ms;}/*!sc*/
.IjnPv:hover::before{opacity:0.05;}/*!sc*/
.IjnPv svg{max-width:calc(0.6 * var(--switch-button-size));max-height:calc(0.6 * var(--switch-button-size));width:100%;height:auto;z-index:1;color:var(--icon-inactive-color);-webkit-transition:color 100ms;transition:color 100ms;}/*!sc*/
.IjnPv svg > *{-webkit-transition:color 100ms,-webkit-transform 200ms,opacity 100ms;-webkit-transition:color 100ms,transform 200ms,opacity 100ms;transition:color 100ms,transform 200ms,opacity 100ms;}/*!sc*/
.IjnPv:first-child{margin-left:var(--switch-padding);}/*!sc*/
.IjnPv:last-child{margin-right:var(--switch-padding);}/*!sc*/
data-styled.g7[id="labelcomponent__Label-sc-ejfxch-0"]{content:"IjnPv,"}/*!sc*/
.fFVsGy{position:absolute;overflow:hidden;-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;border:0;}/*!sc*/
data-styled.g8[id="sc-bdvvtL"]{content:"fFVsGy,"}/*!sc*/
.jUBSlw{width:24px;height:24px;}/*!sc*/
data-styled.g9[id="rsscomponent__Svg-sc-9izxto-0"]{content:"jUBSlw,"}/*!sc*/
.bMMNQX{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:-webkit-sticky;position:sticky;z-index:1;top:0;left:0;right:0;background:var(--bg);height:60px;}/*!sc*/
.bMMNQX .switchercomponent__Switcher-sc-mlsxp7-0{margin-left:auto;}/*!sc*/
@media print{.bMMNQX{display:none;}}/*!sc*/
data-styled.g10[id="navbarcomponent__Wrapper-sc-1kms0v-0"]{content:"bMMNQX,"}/*!sc*/
.jzkOoE{font-weight:800;font-size:0.9rem;color:var(--header);padding:0 10px;box-shadow:none;}/*!sc*/
@media screen and (min-width:375px){.jzkOoE{font-size:1.125rem;}}/*!sc*/
@media screen and (min-width:768px){.jzkOoE{font-size:1.625rem;}}/*!sc*/
data-styled.g11[id="navbarcomponent__Brand-sc-1kms0v-1"]{content:"jzkOoE,"}/*!sc*/
.cdqiJn{display:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0;padding:0;}/*!sc*/
@media screen and (min-width:768px){.cdqiJn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
data-styled.g13[id="navbarcomponent__List-sc-1kms0v-3"]{content:"cdqiJn,"}/*!sc*/
.cMIgKv{display:block;margin:0;padding:0 0.4375rem;font-weight:600;}/*!sc*/
data-styled.g14[id="navbarcomponent__NavItem-sc-1kms0v-4"]{content:"cMIgKv,"}/*!sc*/
.hOQmkp{-webkit-text-decoration:none;text-decoration:none;box-shadow:none;}/*!sc*/
.hOQmkp.active{box-shadow:0 1px 0 0 currentColor;}/*!sc*/
data-styled.g15[id="navbarcomponent__ExtendLink-sc-1kms0v-5"]{content:"hOQmkp,"}/*!sc*/
.issidU{height:24px;color:var(--header);opacity:0.4;padding:0 20px;}/*!sc*/
.issidU:hover,.issidU:focus{opacity:1;}/*!sc*/
data-styled.g16[id="navbarcomponent__RssLink-sc-1kms0v-6"]{content:"issidU,"}/*!sc*/
.eOaYOT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:4rem;}/*!sc*/
data-styled.g17[id="footercomponent__FooterWrapper-sc-1ogqr1t-0"]{content:"eOaYOT,"}/*!sc*/
.iegdlW{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;display:none !important;border-radius:50%;-webkit-transition:border-radius 300ms ease-in;transition:border-radius 300ms ease-in;}/*!sc*/
@media screen and (min-width:1024px){.iegdlW{display:inline-block !important;}}/*!sc*/
data-styled.g18[id="foundationcomponent__Logo-sc-hocuye-0"]{content:"iegdlW,"}/*!sc*/
.eTWzsT{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;margin:0 1rem;padding-left:0.2rem;font-weight:600;}/*!sc*/
data-styled.g19[id="foundationcomponent__TextWrapper-sc-hocuye-1"]{content:"eTWzsT,"}/*!sc*/
.icQYkE{border:none;margin:0;}/*!sc*/
data-styled.g20[id="foundationcomponent__Blocquote-sc-hocuye-2"]{content:"icQYkE,"}/*!sc*/
.gsWdLS{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;color:var(--textNormal);box-shadow:none;-webkit-transition:all 200ms ease-in;transition:all 200ms ease-in;border-radius:0.75rem;}/*!sc*/
.gsWdLS:hover,.gsWdLS:focus{background:#ea684c;box-shadow:2px 4px 8px hsl(0deg 0% 0% / 0.25);}/*!sc*/
data-styled.g21[id="foundationcomponent__StyledLink-sc-hocuye-3"]{content:"gsWdLS,"}/*!sc*/
.jZYdzq{margin:0;padding:0;}/*!sc*/
data-styled.g22[id="listcomponent__List-sc-1nc5peu-0"]{content:"jZYdzq,"}/*!sc*/
.bJPulw{display:block;margin:0;padding:0;}/*!sc*/
data-styled.g23[id="listcomponent__ListItem-sc-1nc5peu-1"]{content:"bJPulw,"}/*!sc*/
.kJjENl{display:none;-webkit-flex:1;-ms-flex:1;flex:1;min-width:300px;margin-left:16px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;}/*!sc*/
.kJjENl nav{margin-left:0.5rem;overflow:auto;max-height:80vh;}/*!sc*/
.kJjENl ul{list-style:none;}/*!sc*/
.kJjENl li{margin-bottom:0.5rem;overflow:hidden;white-space:nowrap;,wordwrap:normal;text-overflow:ellipsis;}/*!sc*/
.kJjENl li > ul{margin-top:0;margin-left:1rem;}/*!sc*/
.kJjENl a{color:currentColor;box-shadow:none;}/*!sc*/
.kJjENl a:hover{box-shadow:0 1px 0 0 currentColor;}/*!sc*/
@media screen and (min-width:1024px){.kJjENl{display:block;position:-webkit-sticky;position:sticky;top:80px;font-size:0.8rem;}}/*!sc*/
data-styled.g31[id="tableOfContentscomponent__Aside-sc-ep791a-0"]{content:"kJjENl,"}/*!sc*/
.gJZcwq{margin-bottom:0.8rem;font-weight:bold;font-size:1.1rem;}/*!sc*/
data-styled.g32[id="tableOfContentscomponent__Heading-sc-ep791a-1"]{content:"gJZcwq,"}/*!sc*/
.iBvGiF{padding:1rem;margin:0.5rem 0;font-weight:bold;background-color:hsla(268,53%,51%,30%);border-radius:0.75rem;border:solid hsla(268,53%,51%) 1px;}/*!sc*/
data-styled.g33[id="availableLanguagescomponent__Container-sc-zfico6-0"]{content:"iBvGiF,"}/*!sc*/
.szUMw{margin-bottom:1rem;}/*!sc*/
data-styled.g34[id="editOnGithubcomponent__Wrapper-sc-zzrn7j-0"]{content:"szUMw,"}/*!sc*/
.gSOsSQ{border-radius:0.75rem;box-shadow:2px 4px 8px hsl(0deg 0% 0% / 0.25);max-width:600px;margin-left:auto;margin-right:auto;}/*!sc*/
data-styled.g35[id="herocomponent__Hero-sc-1fcjco-0"]{content:"gSOsSQ,"}/*!sc*/
.kXokDR{font-size:1.7rem;}/*!sc*/
data-styled.g36[id="pageTitlecomponent__PageTitle-sc-la92g4-0"]{content:"kXokDR,"}/*!sc*/
.dpXDbg{margin-top:2rem;}/*!sc*/
data-styled.g37[id="blog-post__PostContent-sc-hrojot-0"]{content:"dpXDbg,"}/*!sc*/
.gGeUFs{margin-left:1rem;}/*!sc*/
data-styled.g38[id="blog-post__RelatedPost-sc-hrojot-1"]{content:"gGeUFs,"}/*!sc*/
.eRQrRu{margin:3rem;}/*!sc*/
data-styled.g39[id="blog-post__SocialFooter-sc-hrojot-2"]{content:"eRQrRu,"}/*!sc*/
.jKxYgw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g40[id="blog-post__Main-sc-hrojot-3"]{content:"jKxYgw,"}/*!sc*/
</style><link rel="canonical" href="https://blog.slashgear.dev/fr/react-redux-pieges-bonnes-pratiques/" data-baseprotocol="https:" data-basehost="blog.slashgear.dev"/><link as="script" rel="preload" href="/webpack-runtime-1be07eacdecde6e37a2e.js"/><link as="script" rel="preload" href="/framework-008207b94a0d8e7b1e0d.js"/><link as="script" rel="preload" href="/app-debec287bb0edc82497f.js"/><link as="script" rel="preload" href="/6cc983252ef082d05857c6f27e42306283885478-339e699220b88e754e05.js"/><link as="script" rel="preload" href="/743791b12bf7cb00b427fac0e2749395f37c471f-8be1a0076bf43c0356de.js"/><link as="script" rel="preload" href="/982adfec591605b2489416210e2fcf136d466ade-3e3c46a1fafbb8d43538.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-3f39259a86d41f0d38d4.js"/><link as="fetch" rel="preload" href="/page-data/fr/react-redux-pieges-bonnes-pratiques/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1264045386.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1666466174.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2564629789.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4061151221.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/62118570.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>!function(e,a,o){function d(e){document.body.classList.add(e?"dark-mode":"light-mode"),document.body.classList.remove(e?"light-mode":"dark-mode")}var t=window.matchMedia("(prefers-color-scheme: dark)"),r="(prefers-color-scheme: dark)"===t.media,s=null;try{s=localStorage.getItem("darkMode")}catch(e){}var c=null!==s;if(c&&(s=JSON.parse(s)),c)d(s);else if(r)d(t.matches),localStorage.setItem("darkMode",t.matches);else{var l=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",JSON.stringify(l))}}();</script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="maxWidthWrapper__MaxWidthWrapper-sc-1wy8f9q-0 navbarcomponent__Wrapper-sc-1kms0v-0 bOzXxU bMMNQX"><a class="navbarcomponent__Brand-sc-1kms0v-1 jzkOoE" href="/fr">Antoine Caron</a><nav class="navbarcomponent__Nav-sc-1kms0v-2 hvakBN"><ul class="navbarcomponent__List-sc-1kms0v-3 cdqiJn"><li class="navbarcomponent__NavItem-sc-1kms0v-4 cMIgKv"><a class="navbarcomponent__ExtendLink-sc-1kms0v-5 hOQmkp" href="/fr">Derniers articles</a></li><li class="navbarcomponent__NavItem-sc-1kms0v-4 cMIgKv"><a class="navbarcomponent__ExtendLink-sc-1kms0v-5 hOQmkp" href="/resume">CV</a></li><li class="navbarcomponent__NavItem-sc-1kms0v-4 cMIgKv"><a class="navbarcomponent__ExtendLink-sc-1kms0v-5 hOQmkp" href="/conferences">Conférences</a></li><li class="navbarcomponent__NavItem-sc-1kms0v-4 cMIgKv"><a hrefLang="en" class="navbarcomponent__ExtendLink-sc-1kms0v-5 hOQmkp" href="/">EN</a></li></ul></nav><div role="radiogroup" aria-label="Theme" data-testid="theme-switcher" class="switchercomponent__Switcher-sc-mlsxp7-0 erDhjp"><label title="light" class="labelcomponent__Label-sc-ejfxch-0 IjnPv"><div class="sc-bdvvtL fFVsGy">Switch to light mode</div><input type="radio" name="theme" value="light" aria-label="light" checked="" class="inputcomponent__Input-sc-1s3keza-0 LNFxg"/><span class="buttoncomponent__Button-sc-t9bezb-0 fqEccz"></span><svg width="12" height="13" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 4C5.33696 4 4.70107 4.26339 4.23223 4.73223C3.76339 5.20107 3.5 5.83696 3.5 6.5C3.5 7.16304 3.76339 7.79893 4.23223 8.26777C4.70107 8.73661 5.33696 9 6 9C6.66304 9 7.29893 8.73661 7.76777 8.26777C8.23661 7.79893 8.5 7.16304 8.5 6.5C8.5 5.83696 8.23661 5.20107 7.76777 4.73223C7.29893 4.26339 6.66304 4 6 4V4Z" fill="currentColor"></path><path id="sun-rays" d="M9.89998 6.49997H10.7978M8.69998 9.19997L8.99998 9.49997M5.99998 10.4L6.00106 11.2989M1.19997 6.49997H2.09781M2.99997 3.49997L3.30004 3.80003M5.99998 1.69996L6.00106 2.59888M3.29997 9.19997L2.99997 9.49997M8.69998 3.79997L8.99998 3.49997" stroke="currentColor" stroke-linecap="round"></path></svg></label><label title="dark" class="labelcomponent__Label-sc-ejfxch-0 IjnPv"><div class="sc-bdvvtL fFVsGy">Switch to dark mode</div><input type="radio" name="theme" value="dark" aria-label="dark" class="inputcomponent__Input-sc-1s3keza-0 LNFxg"/><span class="buttoncomponent__Button-sc-t9bezb-0 fqEccz"></span><svg width="10" height="11" viewBox="0 0 10 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.75077 0.673362C3.81179 0.74751 3.84918 0.838253 3.85809 0.933867C3.86701 1.02948 3.84704 1.12557 3.80078 1.20972C3.43937 1.87328 3.25063 2.61707 3.25192 3.37267C3.25192 5.88631 5.30109 7.92173 7.82661 7.92173C8.15606 7.92173 8.47675 7.88735 8.78493 7.82171C8.87941 7.80125 8.97781 7.80908 9.06787 7.84421C9.15792 7.87934 9.23563 7.94022 9.29129 8.01925C9.35005 8.10142 9.38 8.20071 9.3765 8.30166C9.37299 8.40262 9.33622 8.49959 9.27191 8.57749C8.78161 9.17976 8.16309 9.66502 7.46143 9.9979C6.75978 10.3308 5.99268 10.5029 5.21607 10.5016C2.33423 10.5016 0 8.17991 0 5.31932C0 3.16638 1.32152 1.31975 3.20316 0.537084C3.29689 0.497471 3.40094 0.48934 3.49969 0.513914C3.59844 0.538488 3.68654 0.594439 3.75077 0.673362Z" fill="currentColor"></path><path class="star" d="M8.83559 3.10006C8.82942 3.11904 8.81786 3.13551 8.80252 3.14716C8.78717 3.15881 8.76881 3.16507 8.74998 3.16507C8.73114 3.16507 8.71278 3.15881 8.69744 3.14716C8.68209 3.13551 8.67053 3.11904 8.66436 3.10006L8.50313 2.58398C8.43127 2.35328 8.26192 2.17259 8.0457 2.09591L7.56201 1.92389C7.54422 1.91731 7.52879 1.90497 7.51787 1.8886C7.50695 1.87223 7.50108 1.85264 7.50108 1.83254C7.50108 1.81245 7.50695 1.79285 7.51787 1.77648C7.52879 1.76011 7.54422 1.74778 7.56201 1.7412L8.0457 1.56917C8.15225 1.53135 8.24908 1.46755 8.32848 1.38282C8.40789 1.2981 8.46769 1.19479 8.50313 1.0811L8.66436 0.565025C8.67053 0.54604 8.68209 0.529578 8.69744 0.517927C8.71278 0.506275 8.73114 0.500014 8.74998 0.500014C8.76881 0.500014 8.78717 0.506275 8.80252 0.517927C8.81786 0.529578 8.82942 0.54604 8.83559 0.565025L8.99682 1.0811C9.03227 1.19479 9.09206 1.2981 9.17147 1.38282C9.25088 1.46754 9.3477 1.53135 9.45426 1.56917L9.93794 1.7412C9.95573 1.74778 9.97116 1.76011 9.98208 1.77648C9.993 1.79285 9.99887 1.81245 9.99887 1.83254C9.99887 1.85264 9.993 1.87223 9.98208 1.8886C9.97116 1.90497 9.95573 1.91731 9.93794 1.92389L9.45426 2.09591C9.23803 2.17259 9.06868 2.35328 8.99682 2.58398L8.83559 3.10006Z" fill="currentColor"></path><path class="star" d="M7.00397 6.40119C6.99501 6.43007 6.97775 6.45519 6.95464 6.473C6.93153 6.49081 6.90374 6.5004 6.87524 6.5004C6.84673 6.5004 6.81895 6.49081 6.79584 6.473C6.77273 6.45519 6.75546 6.43007 6.7465 6.40119L6.50466 5.62641C6.39655 5.28103 6.14284 5.01032 5.81913 4.89497L5.09298 4.63694C5.06592 4.62737 5.04237 4.60896 5.02567 4.5843C5.00898 4.55964 5 4.53 5 4.49958C5 4.46917 5.00898 4.43952 5.02567 4.41487C5.04237 4.39021 5.06592 4.37179 5.09298 4.36223L5.81913 4.10419C5.97878 4.04744 6.12385 3.95179 6.24284 3.82484C6.36183 3.69788 6.45147 3.54309 6.50466 3.37275L6.7465 2.59797C6.75546 2.5691 6.77273 2.54397 6.79584 2.52616C6.81895 2.50835 6.84673 2.49877 6.87524 2.49877C6.90374 2.49877 6.93153 2.50835 6.95464 2.52616C6.97775 2.54397 6.99501 2.5691 7.00397 2.59797L7.24581 3.37275C7.299 3.54309 7.38864 3.69788 7.50763 3.82484C7.62662 3.95179 7.77169 4.04744 7.93134 4.10419L8.65749 4.36223C8.68456 4.37179 8.70811 4.39021 8.7248 4.41487C8.74149 4.43952 8.75047 4.46917 8.75047 4.49958C8.75047 4.53 8.74149 4.55964 8.7248 4.5843C8.70811 4.60896 8.68456 4.62737 8.65749 4.63694L7.93134 4.89497C7.77169 4.95173 7.62662 5.04737 7.50763 5.17433C7.38864 5.30129 7.299 5.45607 7.24581 5.62641L7.00397 6.40119Z" fill="currentColor"></path></svg></label></div><a class="navbarcomponent__ExtendLink-sc-1kms0v-5 navbarcomponent__RssLink-sc-1kms0v-6 hOQmkp issidU" href="/rss.xml"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 461.432 461.432" class="rsscomponent__Svg-sc-9izxto-0 jUBSlw"><title>RSS link</title><g id="lines__x003C_Group_x003E_" fill="currentColor"><g id="circle"><path d="M125.896,398.928c0,33.683-27.308,60.999-61.022,60.999c-33.684,0-61.006-27.316-61.006-60.999 c0-33.729,27.322-61.038,61.006-61.038C98.588,337.89,125.896,365.198,125.896,398.928z"></path></g><g><g><path d="M0,229.636c0,8.441,6.606,15.379,15.036,15.809c60.318,3.076,100.885,25.031,138.248,62.582 c36.716,36.864,60.071,89.759,64.082,137.769c0.686,8.202,7.539,14.524,15.77,14.524h56.701c4.344,0,8.498-1.784,11.488-4.935 c2.992-3.15,4.555-7.391,4.333-11.729c-8.074-158.152-130.669-278.332-289.013-286.23c-4.334-0.217-8.564,1.355-11.709,4.344 C1.792,164.759,0,168.908,0,173.247V229.636z"></path></g></g><g><g><path d="M0,73.411c0,8.51,6.713,15.482,15.216,15.819c194.21,7.683,350.315,161.798,358.098,355.879 c0.34,8.491,7.32,15.208,15.818,15.208h56.457c4.297,0,8.408-1.744,11.393-4.834c2.985-3.09,4.585-7.258,4.441-11.552 C453.181,199.412,261.024,9.27,16.38,1.121C12.089,0.978,7.925,2.583,4.838,5.568C1.751,8.551,0,12.661,0,16.954V73.411z"></path></g></g></g></svg></a></header><div class="maxWidthWrapper__MaxWidthWrapper-sc-1wy8f9q-0 bOzXxU"><div class="herocomponent__Hero-sc-1fcjco-0 gSOsSQ gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:51.333333333333336%"></div><noscript><picture><source type='image/webp' srcset="/static/ee72c19029938b25ca14c9387d5095ab/e7487/redux.webp 150w,
/static/ee72c19029938b25ca14c9387d5095ab/403a4/redux.webp 300w,
/static/ee72c19029938b25ca14c9387d5095ab/ad85c/redux.webp 600w,
/static/ee72c19029938b25ca14c9387d5095ab/210c1/redux.webp 900w,
/static/ee72c19029938b25ca14c9387d5095ab/99238/redux.webp 1200w,
/static/ee72c19029938b25ca14c9387d5095ab/82a90/redux.webp 3557w" sizes="(max-width: 600px) 100vw, 600px" /><source srcset="/static/ee72c19029938b25ca14c9387d5095ab/aabdf/redux.jpg 150w,
/static/ee72c19029938b25ca14c9387d5095ab/9dc27/redux.jpg 300w,
/static/ee72c19029938b25ca14c9387d5095ab/4fe8c/redux.jpg 600w,
/static/ee72c19029938b25ca14c9387d5095ab/9842e/redux.jpg 900w,
/static/ee72c19029938b25ca14c9387d5095ab/47498/redux.jpg 1200w,
/static/ee72c19029938b25ca14c9387d5095ab/3b765/redux.jpg 3557w" sizes="(max-width: 600px) 100vw, 600px" /><img loading="lazy" sizes="(max-width: 600px) 100vw, 600px" srcset="/static/ee72c19029938b25ca14c9387d5095ab/aabdf/redux.jpg 150w,
/static/ee72c19029938b25ca14c9387d5095ab/9dc27/redux.jpg 300w,
/static/ee72c19029938b25ca14c9387d5095ab/4fe8c/redux.jpg 600w,
/static/ee72c19029938b25ca14c9387d5095ab/9842e/redux.jpg 900w,
/static/ee72c19029938b25ca14c9387d5095ab/47498/redux.jpg 1200w,
/static/ee72c19029938b25ca14c9387d5095ab/3b765/redux.jpg 3557w" src="/static/ee72c19029938b25ca14c9387d5095ab/4fe8c/redux.jpg" alt="React/Redux : pièges et meilleures pratiques" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><h1 style="color:var(--header)" class="pageTitlecomponent__PageTitle-sc-la92g4-0 kXokDR">React/Redux : pièges et meilleures pratiques</h1><div style="font-size:0.83255rem;line-height:1.75rem;margin-bottom:1.75rem;margin-top:-1.75rem"><time dateTime="2021-03-23">March 23, 2021</time><small style="margin-left:1rem"><a style="margin-right:0.5rem" href="/fr/react">#<!-- -->react</a><a style="margin-right:0.5rem" href="/fr/redux">#<!-- -->redux</a><a style="margin-right:0.5rem" href="/fr/web">#<!-- -->web</a></small></div><main class="blog-post__Main-sc-hrojot-3 jKxYgw"><div style="flex:3;min-width:50vw;max-width:70vw"><div id="lang-switcher" class="availableLanguagescomponent__Container-sc-zfico6-0 iBvGiF">Article disponible en<!-- -->:<!-- --> <a style="box-shadow:none;text-decoration:none" hrefLang="en" href="/react-redux-pitfalls-and-best-pratices">English</a></div><main class="blog-post__PostContent-sc-hrojot-0 dpXDbg"><p>Après 2 ans d’utilisation de React avec Redux pour la plateforme vidéo <a href="https://6play.fr">6play</a>, j’ai pu identifier les bonnes pratiques et les pièges à éviter à tout prix.
L’équipe de <a href="https://www.bedrockstreaming.com/">Bedrock</a> (à laquelle j’appartiens actuellement) a maintenu la pile technique du projet à jour pour profiter des nouvelles fonctionnalités de <code class="language-text">react</code>, <code class="language-text">react-redux</code> et <code class="language-text">redux</code>.</p>
<p>Voici donc mes conseils pour maintenir et utiliser React et Redux dans votre application sans devenir fou.</p>
<p>Cet article n’est pas une introduction à React ou Redux. Je vous recommande <a href="https://redux.js.org/basics/usage-with-react">cette documentation</a> si vous voulez voir comment les mettre en œuvre dans vos applications.</p>
<p>Vous pouvez également jeter un coup d’œil au <a href="https://redux.js.org/style-guide/style-guide">guide de style officiel de Redux</a> dans lequel vous pourriez trouver certains de ces conseils et d’autres.
Notez que si vous utilisez le <a href="https://redux-toolkit.js.org/">Redux Toolkit</a>, certaines des astuces/pratiques présentées dans cet article sont déjà intégrées directement dans l’API.</p>
<h2 id="évitez-davoir-un-seul-reducer" style="position:relative;"><a href="#%C3%A9vitez-davoir-un-seul-reducer" aria-label="évitez davoir un seul reducer permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Évitez d’avoir un seul reducer</h2>
<p>Le <a href="https://redux.js.org/basics/reducers">reducer</a> est la fonction qui est en charge de construire un nouvel état à chaque <code class="language-text">action</code>.
On pourrait être tenté de ne manipuler qu’un seul reducer.
Dans le cas d’une petite application, ce n’est pas un problème.
Pour les applications exprimant une activité complexe et évolutive, il est préférable d’opter pour la solution [combineReducers].</p>
<p>Cette fonctionnalité de <code class="language-text">redux</code> permet de manipuler non pas un mais plusieurs <a href="https://redux.js.org/basics/reducers">reducer</a>s qui agissent respectivement sur l’état.</p>
<blockquote>
<p>Quand et comment scinder son application ?</p>
</blockquote>
<p>Ce que nous recommandons à Bedrock, c’est un découpage fonctionnel de l’application.
Dans mon approche, nous aurions tendance à représenter le métier de l’application plus que les trucs techniques sous-entendus.
De très bons articles l’expliquent notamment par l’utilisation des <a href="https://en.wikipedia.org/wiki/Domain-driven_design">principes DDD</a>.</p>
<p>À Bedrock, nous utilisons un dossier nommé <em>modules</em> qui regroupe les différents dossiers associés à la fonctionnalité de votre application.</p>
<div class="gatsby-highlight" data-language="txt"><pre class="language-txt"><code class="language-txt">app/
  modules/
    user/
      __tests__/
        user.reducer.spec.js
      components/
      user.reducer.js
    product/
      __tests__/
        product.reducer.spec.js
      components/
      product.reducer.js
    account/
      __tests__/
      account.reducer.spec.js
      components/
      account.reducer.js
  store.js
  index.js</code></pre></div>
<p>Ainsi, dans <code class="language-text">store.js</code>, tout ce que vous avez à faire est de combiner vos différents reducers.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> combineReducers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./modules/user/user.reducer.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> product <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./modules/user/product.reducer.js'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> account <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./modules/user/account.reducer.js'</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span> user<span class="token punctuation">,</span> product<span class="token punctuation">,</span> account <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>En suivant ce principe, vous allez :</p>
<ul>
<li>garder les reducers lisibles car ils ont une portée limitée.</li>
<li>structurer et définir les fonctionnalités de votre application</li>
<li>faciliter les tests</li>
</ul>
<p>Historiquement, cette segmentation nous a permis de supprimer des domaines d’application complets sans avoir d’impact sur l’ensemble du codebase, simplement en supprimant le dossier <code class="language-text">module</code> associé à la fonctionnalité.</p>
<h3 id="accès-par-proxy-à-létat" style="position:relative;"><a href="#acc%C3%A8s-par-proxy-%C3%A0-l%C3%A9tat" aria-label="accès par proxy à létat permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Accès par proxy à l’état</h3>
<p>Maintenant que vos reducers ont été placés dans le <code class="language-text">module</code> fonctionnel, vous devez permettre à vos composants d’accéder à l’état via un <code class="language-text">selector</code>.
Un <code class="language-text">selector</code> est une fonction qui a l’<code class="language-text">state</code> comme paramètre, et récupère ses informations.
Cela peut aussi vous permettre de ne sélectionner que les props nécessaires au composant en vous découplant de la structure de l’état.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getUserName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> user<span class="token operator">:</span> <span class="token punctuation">{</span> lastName <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> lastName</code></pre></div>
<p>Vous pouvez également passer des paramètres à un “sélecteur” en l’entourant d’une fonction.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getProduct</span> <span class="token operator">=</span>
  <span class="token punctuation">(</span><span class="token parameter">productId</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> product<span class="token operator">:</span> <span class="token punctuation">{</span> list <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span>
    list<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">product</span><span class="token punctuation">)</span> <span class="token operator">=></span> product<span class="token punctuation">.</span>id <span class="token operator">===</span> productId<span class="token punctuation">)</span></code></pre></div>
<p>Cela vous permettra de les utiliser dans vos composants en utilisant le crochet <a href="https://redux.js.org/recipes/usage-with-typescript#typing-the-useselector-hook">useSelector</a>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> product <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token function">getProduct</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></div>
<p>Il est spécifié dans la doc <code class="language-text">react-redux</code> que le <em>selector</em> est appelé pour chaque rendu du composant.
Si la référence de la fonction <code class="language-text">selector</code> ne change pas, une version en cache de l’objet peut être retournée directement.</p>
<div class="gatsby-highlight" data-language="txt"><pre class="language-txt"><code class="language-txt">app/
  modules/
    user/
      __tests__/
        user.reducer.spec.js
      components/
      user.reducer.js
      user.selectors.js &lt;--- This is where all module selectors are exported</code></pre></div>
<h3 id="préfixer-le-nom-de-vos-actions" style="position:relative;"><a href="#pr%C3%A9fixer-le-nom-de-vos-actions" aria-label="préfixer le nom de vos actions permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Préfixer le nom de vos actions</h3>
<blockquote>
<p>Je vous conseille vraiment de définir des règles de nommage pour vos actions et si possible de les vérifier avec une règle <code class="language-text">eslint</code>.</p>
</blockquote>
<p>Les actions sont en lettres majuscules séparées par ’_‘.
Voici un exemple avec cette action : <code class="language-text">SET_USERS</code>.</p>
<div class="gatsby-highlight" data-language="txt"><pre class="language-txt"><code class="language-txt">app/
  modules/
    user/
      __tests__/
        user.reducer.spec.js
      components/
      user.actions.js &lt;--- This is where all module action creators are exported
      user.reducer.js
      user.selectors.js</code></pre></div>
<p>Les noms des actions sont préfixés par le nom du <code class="language-text">module</code> dans lequel il se trouve.
Cela donne un nom complet : <code class="language-text">user/SET_USERS</code>.
Un grand avantage de cette règle de nommage est que vous pouvez facilement filtrer l’action dans <a href="https://github.com/reduxjs/redux-devtools">redux-devtools</a>.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6ddc87a11f1bc6add7fb7ee327893e94/10f47/redux-devtools.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB8UlEQVQ4y61U2Y6bQBDkd3xhjLnvwzCAARvI2l6vIyX//xEVdRssr5JI8SoPpe6Z6Smqj0HS3QyavYPuZFDNBFZQwvQLqFYCJyyRlj3SokciOsSiw/54RTt8R9Pf0J1+YLj8hKjPiLIDgrSB5IYldGcHw8mw1gIsFBfztQPVjJGVPQdVhzPa4Yq6u6BsTyjqN4j6DXV3RdNdkRYd8mpgSG5UwfYFEy03LlYbj33NShHnByy1CLIRYWsF0KwAqulD0XzIqsdYqx7fIREEyYv38OM9lhvvATrYWgl2ZY/FxsOMguX7BbIL5e6TZV+2MRshuWGFIKmh6OEY5PIBp1wNvEdrtmubyWdPBIxRHSuklKNdC9sveIMULkaFRDh9YP506U+YYrgpYdqwStPNIW/9R8qvEH5SSJ2kOipaiJX6HwhJIdmphlRomkluyquE3khIdmsmjIfCrxDaQcHpWp6AZqeQt8HnsXmZ0BfgWUxqHpUpZVJKL+BLCqnDREzqluNLoRqmYiJ0/p2QfgBESAo3RsQzOF/fBzsVx/uMrazfh/kZ4zkTBmkLN2ng71oYfgHNyaG7gn3a0z3B0Nz8r9YMKxiegGJEkOLyGyJCMaA4XlF1N6T7E8rug23evmNXn1H1N7bTOm8vyBrCGUX3wb44vOMXXDMXpq23M4cAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/6ddc87a11f1bc6add7fb7ee327893e94/ba381/redux-devtools.webp 200w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/7f61c/redux-devtools.webp 400w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/d00b9/redux-devtools.webp 800w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/92f8c/redux-devtools.webp 1200w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/fad48/redux-devtools.webp 1600w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/8ed74/redux-devtools.webp 2726w"
              sizes="(max-width: 800px) 100vw, 800px"
              type="image/webp"
            />
          <source
            srcset="/static/6ddc87a11f1bc6add7fb7ee327893e94/772e8/redux-devtools.png 200w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/e17e5/redux-devtools.png 400w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/5a190/redux-devtools.png 800w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/c1b63/redux-devtools.png 1200w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/29007/redux-devtools.png 1600w,
/static/6ddc87a11f1bc6add7fb7ee327893e94/10f47/redux-devtools.png 2726w"
            sizes="(max-width: 800px) 100vw, 800px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/6ddc87a11f1bc6add7fb7ee327893e94/5a190/redux-devtools.png"
            alt="redux-devtools screenshot"
            title="redux-devtools screenshot"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="toujours-tester-vos-reducers" style="position:relative;"><a href="#toujours-tester-vos-reducers" aria-label="toujours tester vos reducers permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Toujours tester vos reducers</h3>
<p>Les <code class="language-text">reducers</code> sont les détenteurs de l’activité de votre application.
Ils manipulent l’état de votre application.</p>
<p><strong>Ce code est donc <em>sensible</em>.</strong></p>
<p>➡️ Une modification peut avoir beaucoup d’impact sur votre application.</p>
<p><strong>Ce code est riche en règles de gestion</strong>.</p>
<p>➡️ Vous devez être sûr que celles-ci sont correctement mises en œuvre.</p>
<p>La bonne nouvelle est que ce code est relativement facile à tester.
Un <a href="https://redux.js.org/basics/reducers">reducer</a> est une fonction unique qui prend 2 paramètres.
Cette fonction retournera un nouvel <code class="language-text">state</code> en fonction du type d’action et de ses paramètres.</p>
<p>Voici la structure standard pour tester les <a href="https://redux.js.org/basics/reducers">reducer</a> avec <a href="https://jestjs.io/">Jest</a> :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'ReducerName'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// Init a new state</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'ACTION'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// Group tests by action type</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should test action with some params'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should test action with other params'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'SECOND_ACTION'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should test action with some params'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Je vous recommande également d’utiliser le package <a href="https://www.npmjs.com/package/deep-freeze">deep-freeze</a> sur votre <code class="language-text">state</code> pour vous assurer que toutes les actions retournent de nouvelles références.</p>
<p>En fin de compte, le fait de tester vos <a href="https://redux.js.org/basics/reducers">reducer</a>s vous permettra de remanier facilement la structure interne de leur état sans risquer d’introduire des régressions.</p>
<h2 id="conserver-limmuabilité-et-la-lisibilité-de-vos-reducers" style="position:relative;"><a href="#conserver-limmuabilit%C3%A9-et-la-lisibilit%C3%A9-de-vos-reducers" aria-label="conserver limmuabilité et la lisibilité de vos reducers permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conserver l’immuabilité et la lisibilité de vos reducers</h2>
<p>Un <a href="https://redux.js.org/basics/reducers">reducer</a> est une fonction qui doit retourner une nouvelle version de l’état contenant ses nouvelles valeurs tout en gardant les mêmes références des objets qui n’ont pas changé.
Cela vous permet de profiter pleinement du <em>partage structurel</em> et d’éviter de faire exploser votre utilisation de la mémoire.
L’utilisation de l’opérateur <em>spread</em> est donc plus que recommandée.</p>
<p>Cependant, dans le cas où l’état a une structure compliquée et profonde, il peut être verbeux de changer l’état sans détruire les références qui ne doivent pas changer.</p>
<p>Par exemple, ici nous voulons surcharger la valeur <code class="language-text">Rhone.Villeurbanne.postal</code> de l’état tout en gardant les objets qui ne changent pas.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
  Rhone<span class="token operator">:</span> <span class="token punctuation">{</span>
    Lyon<span class="token operator">:</span> <span class="token punctuation">{</span>
      postal<span class="token operator">:</span> <span class="token string">'69000'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    Villeurbanne<span class="token operator">:</span> <span class="token punctuation">{</span>
      postal<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Isère<span class="token operator">:</span> <span class="token punctuation">{</span>
    Grenoble<span class="token operator">:</span> <span class="token punctuation">{</span>
      postal<span class="token operator">:</span> <span class="token string">'39000'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// When you want to change nested state value and use immutability</span>
<span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>state<span class="token punctuation">,</span>
  Rhone<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>state<span class="token punctuation">.</span>Lyon<span class="token punctuation">,</span>
    Villeurbanne<span class="token operator">:</span> <span class="token punctuation">{</span>
      postal<span class="token operator">:</span> <span class="token string">'69100'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Pour éviter cela, <a href="https://github.com/flepretre">un membre de l’équipe Bedrock</a> a publié un paquet qui permet de <code class="language-text">set</code> des attributs imbriqués tout en assurant l’immutabilité : <a href="https://www.npmjs.com/package/immutable-set">immutable-set</a>
Ce paquet est beaucoup plus facile à utiliser que des outils comme <a href="https://immutable-js.github.io/immutable-js/">immutable.js</a> car il n’utilise pas de prototype d’objet.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token keyword">set</span> <span class="token keyword">from</span> <span class="token string">'immutable-set'</span>

<span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token function">set</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Rhone.Villeurbanne.postal</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">'69100'</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="ne-pas-utiliser-le-cas-par-défaut" style="position:relative;"><a href="#ne-pas-utiliser-le-cas-par-d%C3%A9faut" aria-label="ne pas utiliser le cas par défaut permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ne pas utiliser le cas par défaut</h2>
<p>L’implémentation d’un <code class="language-text">redux</code> <a href="https://redux.js.org/basics/reducers">reducer</a> consiste très souvent en un <code class="language-text">switch</code> où chaque <code class="language-text">case</code> correspond à une <code class="language-text">action</code>.
Un <code class="language-text">switch</code> doit toujours définir le cas <code class="language-text">default</code> si vous suivez les règles <code class="language-text">eslint</code> de base.</p>
<p>Imaginons le <a href="https://redux.js.org/basics/reducers">reducer</a> suivant :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
  index<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">initialState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'FOO'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Nous pouvons dire naïvement que ce <a href="https://redux.js.org/basics/reducers">reducer</a> gère deux actions différentes. Ce n’est pas le cas.
Si nous isolons ce <a href="https://redux.js.org/basics/reducers">reducer</a>, il n’y a que deux types d‘“actions” qui peuvent changer cet état : l’action “OFO” et toute autre action.</p>
<p>Cependant, si vous avez suivi le conseil de découper vos reducers, vous n’avez pas qu’un seul reducer agissant sur votre store.</p>
<p>C’est là que le <a href="https://redux.js.org/basics/reducers">reducer</a> précédent pose problème.
En effet, toute autre action changera cet état en un état <code class="language-text">default</code>.
Une action <code class="language-text">dispatch</code> passera par chacun des reducers associés à celui-ci.
Une action à l’autre bout de votre application pourrait affecter cet état sans être exprimée dans le code.
Ceci doit être évité.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 721px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADBUlEQVQoz31TS28TZxS9cZJuumgpi/YHdN1KIAES6RTW3aFu+iP4CV1UEVKlKohFi6ApAhKqRIJQIC4JdsKMkzTO+D3jedljeybjGT9jiHFsz8w3H7eyDZuq4kpH93XO0d1cgA/E3NwcIGIIEWf/A3hwbR5wf+/TTox9dMLH/d7B/rATY3+D3Zw9HeaEmbUXiRnxsD999tzFT74+e/6zCxcvnQaY+njxjztXnj/fuM5xsZ/Ww+H5jc3Nawu/LMwBQMiORn42oy8wsnjbZe/eodWtCMIWX4KVZ7uwtLYNGzvq6CJo+wgDRLC6OO4BYLYWTOp3/cwoD1d//9JLxA/NyCba21F0UwkZ9uXmDTZlrGwnKktc2nqwxZdX1Rpdkm1vWXHIsmAOlv/JN/7U6vSebHv3tRq9tyfWV/KHw2WpRu+rsnMVM/z3b7PpH2pPHp+GhNZGLlUZI5ap4G7OQL0VoFbzUW8GqNh9TOtt1Ft0MmsFmCw0Uau7WGwEKDnkYc9sAIopqD9ZAyg0AlI5QlI6IiRZyRI2x5IDnSd6i5CcWSU7Ekc4kSVpo0iKzYAcFNOEEzkSk2KuVO2g6tDVAkFoa8ZHr7YiU6DWfCzUg0CrD2mqrFM2m6Q7+QwVzS7lNZO+zPA0mtyncaVIBaNLd0RhzIlrki/bb1BxgodmB6HUoiHBJgCq478dnV6oB1hqIaq2j7Llomj2UK4OUTRO8EBqoGJ7k5nlolx1x9xig2Lecu8WGwT0ZhDKGgOAVOnkTLrcv5wunzBJvcvkzAEjVj0mbweM1kDmKd+8MH8rfKnUwW8Ey/tWsDxGsFwmqR8zqXLvMl/sfT4yylT68FLoAOQtFxTHB8X2xtBbCKU2QukYQVF1eM3f/EoML3y3l1CgNkTQ25P9e0260p9oHR9YcWIYUhwvJNteSHmHsnE4jTcAjvOLp46kSL8tRbGnPT1PhV+hWlFn3/NGmqwxmBqbOz7EC93/f7ljYQm6iR9hsH0m9Fr+e/2VFJYHhcdf9Avr0FP/mvrQu/4Lfs2JXdzxoq0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/847fbba6812318a026c231349b6a15c2/ba381/combineReducer.webp 200w,
/static/847fbba6812318a026c231349b6a15c2/7f61c/combineReducer.webp 400w,
/static/847fbba6812318a026c231349b6a15c2/c71bf/combineReducer.webp 721w"
              sizes="(max-width: 721px) 100vw, 721px"
              type="image/webp"
            />
          <source
            srcset="/static/847fbba6812318a026c231349b6a15c2/772e8/combineReducer.png 200w,
/static/847fbba6812318a026c231349b6a15c2/e17e5/combineReducer.png 400w,
/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png 721w"
            sizes="(max-width: 721px) 100vw, 721px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png"
            alt="schéma du reducer combiné"
            title="schéma du reducer combiné"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>Si vous voulez modifier l’état avec une action d’un autre module, vous pouvez le faire en ajoutant un <code class="language-text">case</code> sur cette action.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'FOO'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'otherModule/BAR'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="utiliser-des-middlewares-personnalisés" style="position:relative;"><a href="#utiliser-des-middlewares-personnalis%C3%A9s" aria-label="utiliser des middlewares personnalisés permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Utiliser des middlewares personnalisés</h2>
<p>J’ai souvent vu des comportements <code class="language-text">action</code> être copiés et collés, d’une action à l’autre.
Quand on est développeur, le “copier-coller” n’est jamais la bonne méthode.</p>
<p>L’exemple le plus courant est la gestion des appels HTTP pendant une action qui utilise <code class="language-text">redux-thunk</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://example.com/api/foo'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'FOO'</span><span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Do something</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://example.com/api/bar'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'BAR'</span><span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Do something</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Ces deux actions sont fondamentalement la même chose, nous pourrions très bien faire une usine qui ferait le code en commun.</p>
<p>En gros, l’action <em>meta</em> que nous voulons représenter ici quand elle est <code class="language-text">dispatchée</code> :</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Récupérer quelque chose
-- retourner l'action avec le résultat
-- en cas d'erreur, faire quelque chose</code></pre></div>
<p>On pourrait très bien définir un middleware qui s’occuperait de ce comportement.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">http</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">store</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>http<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      action<span class="token punctuation">.</span>result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>http<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Do something</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// in redux store init</span>
<span class="token keyword">const</span> exampleApp <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span>reducers<span class="token punctuation">)</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>exampleApp<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>http<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>Ainsi, les deux actions précédentes pourraient être écrites de manière beaucoup plus simple :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'FOO'</span><span class="token punctuation">,</span> http<span class="token operator">:</span> <span class="token string">'https://example.com/api/foo'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'BAR'</span><span class="token punctuation">,</span> http<span class="token operator">:</span> <span class="token string">'https://example.com/api/bar'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Les grands avantages de l’utilisation d’un intergiciel dans une application complexe :</p>
<ul>
<li>évite la duplication du code</li>
<li>vous permet de définir des comportements communs entre vos actions</li>
<li>standardisation des types d’actions redux <em>meta</em>.</li>
</ul>
<h2 id="éviter-le-rerender-lié-à-redux" style="position:relative;"><a href="#%C3%A9viter-le-rerender-li%C3%A9-%C3%A0-redux" aria-label="éviter le rerender lié à redux permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Éviter le rerender lié à redux</h2>
<p>L’astuce quand on utilise redux est de déclencher le re-render des composants quand on les connecte à l’état.
Même si [les re-render ne sont pas toujours un problème], le re-render causé par l’utilisation de redux doit vraiment être évité.
Il suffit de se méfier des pièges suivants.</p>
<h3 id="ne-pas-créer-de-référence-dans-le-selector" style="position:relative;"><a href="#ne-pas-cr%C3%A9er-de-r%C3%A9f%C3%A9rence-dans-le-selector" aria-label="ne pas créer de référence dans le selector permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ne pas créer de référence dans le <em>selector</em>.</h3>
<p>Imaginons le prochain <em>sélecteur</em> :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">getUserById</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">userId</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  state<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> user<span class="token punctuation">.</span>id <span class="token operator">===</span> userId<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre></div>
<p>Ici, le développeur voulait s’assurer que son <em>sélecteur</em> est protégé contre les nullités et renvoie toujours un <em>objet</em>.
C’est quelque chose que nous voyons assez souvent.</p>
<p>Chaque fois que ce sélecteur sera appelé pour un <code class="language-text">utilisateur</code> non présent dans l’état, il retournera un nouvel objet, une nouvelle référence.</p>
<blockquote>
<p>Avec <a href="">useSelector</a>, retourner un nouvel objet à chaque fois forcera toujours un re-rendu par défaut.
<a href="https://react-redux.js.org/api/hooks#equality-comparisons-and-updates">Doc de react-redux</a></p>
</blockquote>
<p>Cependant, dans le cas d’un objet, comme dans l’exemple ci-dessus (ou d’un tableau), la référence de cette valeur par défaut est nouvelle à chaque fois que le sélecteur est exécuté.
De même pour les valeurs par défaut dans la déstructuration, vous ne devriez jamais faire ceci :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">getUsers</span> <span class="token operator">=</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> users<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span>
    users</code></pre></div>
<p>Que faire alors ?
Dans la mesure du possible, les valeurs par défaut doivent être stockées dans le reducer.
Sinon, la valeur par défaut doit être extraite dans une constante afin que la référence reste la même.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> defaultUser <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">getUserById</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">userId</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  state<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> user<span class="token punctuation">.</span>id <span class="token operator">===</span> userId<span class="token punctuation">)</span> <span class="token operator">||</span> defaultUser</code></pre></div>
<p>Il en va de même pour l’utilisation du sélecteur qui renvoie une nouvelle référence à chaque appel.
L’utilisation de la fonction <code class="language-text">filter</code> renvoie un nouveau tableau à chaque fois une nouvelle référence même si les conditions du filtre n’ont pas changé.</p>
<p>Pour continuer, il est important que <a href="https://redux.js.org/recipes/usage-with-typescript#typing-the-useselector-hook">useSelector</a> ne renvoie pas une fonction.
En fait, vous ne devez jamais faire cela :</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">getUserById</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter">userId</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  state<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> user<span class="token punctuation">.</span>id <span class="token operator">===</span> userId<span class="token punctuation">)</span>
<span class="token keyword">const</span> uider <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span>getUserById<span class="token punctuation">)</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span></code></pre></div>
<p>Un sélecteur ne doit pas retourner une <em>vue</em> (une copie) de l’état mais directement ce qu’il contient.
En respectant ce principe, vos composants ne se rendront que si une action modifie l’état.
Des utilitaires tels que <a href="https://www.npmjs.com/package/reselect">reselect</a> peuvent être utilisés pour implémenter des sélecteurs avec un système de mémoire.</p>
<h3 id="ne-transformez-pas-vos-données-dans-les-composants" style="position:relative;"><a href="#ne-transformez-pas-vos-donn%C3%A9es-dans-les-composants" aria-label="ne transformez pas vos données dans les composants permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ne transformez pas vos données dans les composants</h3>
<p>Parfois, les données contenues dans le <code class="language-text">state</code> ne sont pas dans le bon format d’affichage.
Nous aurions rapidement tendance à la générer directement dans le composant.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span>getUser<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">></span>
      <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://profil-pic.com/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Ici, l’url de l’image est calculée dynamiquement dans le composant, et donc à chaque rendu.
Nous préférons modifier nos reducers afin d’inclure un attribut <code class="language-text">profileUrl</code> pour que cette information soit directement accessible.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">user/SET_USER</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>state<span class="token punctuation">,</span>
      user<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>action<span class="token punctuation">.</span>user<span class="token punctuation">,</span>
        profilUrl<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://profil-pic.com/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>action<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Ces informations sont ensuite calculées une fois par action et non à chaque fois qu’elles sont rendues.</p>
<h2 id="nutilisez-pas-usereducer-pour-vos-données-professionnelles" style="position:relative;"><a href="#nutilisez-pas-usereducer-pour-vos-donn%C3%A9es-professionnelles" aria-label="nutilisez pas usereducer pour vos données professionnelles permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>N’utilisez pas <em>useReducer</em> pour vos données professionnelles</h2>
<p>Depuis l’arrivée des hooks, nous avons beaucoup plus d’outils fournis directement par React pour gérer l’état de nos composants.
Le hook <a href="https://fr.reactjs.org/docs/hooks-reference.html#usereducer">useReducer</a> permet de définir un état qui pourra être modifié par des actions.
On est vraiment très très proche d’un état redux que l’on peut associer à un composant, c’est génial.</p>
<p>Cependant, si vous utilisez redux dans votre application, il semble assez étrange de devoir utiliser <a href="https://fr.reactjs.org/docs/hooks-reference.html#usereducer">useReducer</a>.
Vous avez déjà tout ce dont vous avez besoin pour manipuler un état complexe.</p>
<p>De plus, en utilisant redux au lieu du hook <a href="https://fr.reactjs.org/docs/hooks-reference.html#usereducer">useReducer</a>, vous pouvez profiter d’outils de développement et de middlewares vraiment efficaces.</p>
<hr>
<h2 id="ressources-utiles" style="position:relative;"><a href="#ressources-utiles" aria-label="ressources utiles permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ressources utiles</h2>
<ul>
<li><a href="https://redux.js.org/basics/usage-with-react">Utiliser react avec redux</a></li>
<li><a href="https://github.com/reduxjs/redux/issues/653#issuecomment-216844781">flux redux animé par Dan Abramov</a>
<img src="/404460ceece985d433e1ed1f36cd4215/redux-flow.gif" alt="flux redux animé par Dan Abramov"></li>
<li><a href="https://redux.js.org/api/applymiddleware">documentation redux sur les middlewares</a></li>
<li><a href="https://www.npmjs.com/package/immutable-set">immutable-set</a></li>
</ul>
<p>Merci aux relecteurs :
<a href="https://github.com/flepretre">@flepretre</a>,
<a href="https://github.com/mfrachet">@mfrachet</a>,
<a href="https://github.com/fdubost">@fdubost</a>,
<a href="https://github.com/ncuillery">@ncuillery</a>,
<a href="https://github.com/renaudAmsellem">@renaudAmsellem</a>_</p></main><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","headline":"React/Redux : pièges et meilleures pratiques","editor":"Antoine Caron","genre":"Tech Blog","wordcount":1711,"url":"https://blog.slashgear.dev/fr/react-redux-pieges-bonnes-pratiques/","mainEntityOfPage":"https://blog.slashgear.dev/fr/react-redux-pieges-bonnes-pratiques/","datePublished":"2021-03-23","dateCreated":"2021-03-23","dateModified":"2021-03-23","description":"Nous utilisons React et Redux depuis presque 4 ans chez Bedrock sur notre plateforme vidéo nommée 6play. Les bonnes pratiques et les erreurs à éviter ont été rassemblées dans cet article.","articleBody":"<p>Après 2 ans d’utilisation de React avec Redux pour la plateforme vidéo <a href=\"https://6play.fr\">6play</a>, j’ai pu identifier les bonnes pratiques et les pièges à éviter à tout prix.\nL’équipe de <a href=\"https://www.bedrockstreaming.com/\">Bedrock</a> (à laquelle j’appartiens actuellement) a maintenu la pile technique du projet à jour pour profiter des nouvelles fonctionnalités de <code class=\"language-text\">react</code>, <code class=\"language-text\">react-redux</code> et <code class=\"language-text\">redux</code>.</p>\n<p>Voici donc mes conseils pour maintenir et utiliser React et Redux dans votre application sans devenir fou.</p>\n<p>Cet article n’est pas une introduction à React ou Redux. Je vous recommande <a href=\"https://redux.js.org/basics/usage-with-react\">cette documentation</a> si vous voulez voir comment les mettre en œuvre dans vos applications.</p>\n<p>Vous pouvez également jeter un coup d’œil au <a href=\"https://redux.js.org/style-guide/style-guide\">guide de style officiel de Redux</a> dans lequel vous pourriez trouver certains de ces conseils et d’autres.\nNotez que si vous utilisez le <a href=\"https://redux-toolkit.js.org/\">Redux Toolkit</a>, certaines des astuces/pratiques présentées dans cet article sont déjà intégrées directement dans l’API.</p>\n<h2 id=\"évitez-davoir-un-seul-reducer\" style=\"position:relative;\"><a href=\"#%C3%A9vitez-davoir-un-seul-reducer\" aria-label=\"évitez davoir un seul reducer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Évitez d’avoir un seul reducer</h2>\n<p>Le <a href=\"https://redux.js.org/basics/reducers\">reducer</a> est la fonction qui est en charge de construire un nouvel état à chaque <code class=\"language-text\">action</code>.\nOn pourrait être tenté de ne manipuler qu’un seul reducer.\nDans le cas d’une petite application, ce n’est pas un problème.\nPour les applications exprimant une activité complexe et évolutive, il est préférable d’opter pour la solution [combineReducers].</p>\n<p>Cette fonctionnalité de <code class=\"language-text\">redux</code> permet de manipuler non pas un mais plusieurs <a href=\"https://redux.js.org/basics/reducers\">reducer</a>s qui agissent respectivement sur l’état.</p>\n<blockquote>\n<p>Quand et comment scinder son application ?</p>\n</blockquote>\n<p>Ce que nous recommandons à Bedrock, c’est un découpage fonctionnel de l’application.\nDans mon approche, nous aurions tendance à représenter le métier de l’application plus que les trucs techniques sous-entendus.\nDe très bons articles l’expliquent notamment par l’utilisation des <a href=\"https://en.wikipedia.org/wiki/Domain-driven_design\">principes DDD</a>.</p>\n<p>À Bedrock, nous utilisons un dossier nommé <em>modules</em> qui regroupe les différents dossiers associés à la fonctionnalité de votre application.</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">app/\n  modules/\n    user/\n      __tests__/\n        user.reducer.spec.js\n      components/\n      user.reducer.js\n    product/\n      __tests__/\n        product.reducer.spec.js\n      components/\n      product.reducer.js\n    account/\n      __tests__/\n      account.reducer.spec.js\n      components/\n      account.reducer.js\n  store.js\n  index.js</code></pre></div>\n<p>Ainsi, dans <code class=\"language-text\">store.js</code>, tout ce que vous avez à faire est de combiner vos différents reducers.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore<span class=\"token punctuation\">,</span> combineReducers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> user <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/user/user.reducer.js'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> product <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/user/product.reducer.js'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> account <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/user/account.reducer.js'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span><span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> user<span class=\"token punctuation\">,</span> product<span class=\"token punctuation\">,</span> account <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>En suivant ce principe, vous allez :</p>\n<ul>\n<li>garder les reducers lisibles car ils ont une portée limitée.</li>\n<li>structurer et définir les fonctionnalités de votre application</li>\n<li>faciliter les tests</li>\n</ul>\n<p>Historiquement, cette segmentation nous a permis de supprimer des domaines d’application complets sans avoir d’impact sur l’ensemble du codebase, simplement en supprimant le dossier <code class=\"language-text\">module</code> associé à la fonctionnalité.</p>\n<h3 id=\"accès-par-proxy-à-létat\" style=\"position:relative;\"><a href=\"#acc%C3%A8s-par-proxy-%C3%A0-l%C3%A9tat\" aria-label=\"accès par proxy à létat permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Accès par proxy à l’état</h3>\n<p>Maintenant que vos reducers ont été placés dans le <code class=\"language-text\">module</code> fonctionnel, vous devez permettre à vos composants d’accéder à l’état via un <code class=\"language-text\">selector</code>.\nUn <code class=\"language-text\">selector</code> est une fonction qui a l’<code class=\"language-text\">state</code> comme paramètre, et récupère ses informations.\nCela peut aussi vous permettre de ne sélectionner que les props nécessaires au composant en vous découplant de la structure de l’état.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUserName</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> user<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> lastName <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> lastName</code></pre></div>\n<p>Vous pouvez également passer des paramètres à un “sélecteur” en l’entourant d’une fonction.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getProduct</span> <span class=\"token operator\">=</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">productId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> product<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> list <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    list<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">product</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> product<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> productId<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Cela vous permettra de les utiliser dans vos composants en utilisant le crochet <a href=\"https://redux.js.org/recipes/usage-with-typescript#typing-the-useselector-hook\">useSelector</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MyComponent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> product <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span><span class=\"token function\">getProduct</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>product<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Il est spécifié dans la doc <code class=\"language-text\">react-redux</code> que le <em>selector</em> est appelé pour chaque rendu du composant.\nSi la référence de la fonction <code class=\"language-text\">selector</code> ne change pas, une version en cache de l’objet peut être retournée directement.</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">app/\n  modules/\n    user/\n      __tests__/\n        user.reducer.spec.js\n      components/\n      user.reducer.js\n      user.selectors.js &lt;--- This is where all module selectors are exported</code></pre></div>\n<h3 id=\"préfixer-le-nom-de-vos-actions\" style=\"position:relative;\"><a href=\"#pr%C3%A9fixer-le-nom-de-vos-actions\" aria-label=\"préfixer le nom de vos actions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Préfixer le nom de vos actions</h3>\n<blockquote>\n<p>Je vous conseille vraiment de définir des règles de nommage pour vos actions et si possible de les vérifier avec une règle <code class=\"language-text\">eslint</code>.</p>\n</blockquote>\n<p>Les actions sont en lettres majuscules séparées par ’_‘.\nVoici un exemple avec cette action : <code class=\"language-text\">SET_USERS</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">app/\n  modules/\n    user/\n      __tests__/\n        user.reducer.spec.js\n      components/\n      user.actions.js &lt;--- This is where all module action creators are exported\n      user.reducer.js\n      user.selectors.js</code></pre></div>\n<p>Les noms des actions sont préfixés par le nom du <code class=\"language-text\">module</code> dans lequel il se trouve.\nCela donne un nom complet : <code class=\"language-text\">user/SET_USERS</code>.\nUn grand avantage de cette règle de nommage est que vous pouvez facilement filtrer l’action dans <a href=\"https://github.com/reduxjs/redux-devtools\">redux-devtools</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6ddc87a11f1bc6add7fb7ee327893e94/10f47/redux-devtools.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB8UlEQVQ4y61U2Y6bQBDkd3xhjLnvwzCAARvI2l6vIyX//xEVdRssr5JI8SoPpe6Z6Smqj0HS3QyavYPuZFDNBFZQwvQLqFYCJyyRlj3SokciOsSiw/54RTt8R9Pf0J1+YLj8hKjPiLIDgrSB5IYldGcHw8mw1gIsFBfztQPVjJGVPQdVhzPa4Yq6u6BsTyjqN4j6DXV3RdNdkRYd8mpgSG5UwfYFEy03LlYbj33NShHnByy1CLIRYWsF0KwAqulD0XzIqsdYqx7fIREEyYv38OM9lhvvATrYWgl2ZY/FxsOMguX7BbIL5e6TZV+2MRshuWGFIKmh6OEY5PIBp1wNvEdrtmubyWdPBIxRHSuklKNdC9sveIMULkaFRDh9YP506U+YYrgpYdqwStPNIW/9R8qvEH5SSJ2kOipaiJX6HwhJIdmphlRomkluyquE3khIdmsmjIfCrxDaQcHpWp6AZqeQt8HnsXmZ0BfgWUxqHpUpZVJKL+BLCqnDREzqluNLoRqmYiJ0/p2QfgBESAo3RsQzOF/fBzsVx/uMrazfh/kZ4zkTBmkLN2ng71oYfgHNyaG7gn3a0z3B0Nz8r9YMKxiegGJEkOLyGyJCMaA4XlF1N6T7E8rug23evmNXn1H1N7bTOm8vyBrCGUX3wb44vOMXXDMXpq23M4cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6ddc87a11f1bc6add7fb7ee327893e94/ba381/redux-devtools.webp 200w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/7f61c/redux-devtools.webp 400w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/d00b9/redux-devtools.webp 800w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/92f8c/redux-devtools.webp 1200w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/fad48/redux-devtools.webp 1600w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/8ed74/redux-devtools.webp 2726w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6ddc87a11f1bc6add7fb7ee327893e94/772e8/redux-devtools.png 200w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/e17e5/redux-devtools.png 400w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/5a190/redux-devtools.png 800w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/c1b63/redux-devtools.png 1200w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/29007/redux-devtools.png 1600w,\n/static/6ddc87a11f1bc6add7fb7ee327893e94/10f47/redux-devtools.png 2726w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6ddc87a11f1bc6add7fb7ee327893e94/5a190/redux-devtools.png\"\n            alt=\"redux-devtools screenshot\"\n            title=\"redux-devtools screenshot\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"toujours-tester-vos-reducers\" style=\"position:relative;\"><a href=\"#toujours-tester-vos-reducers\" aria-label=\"toujours tester vos reducers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Toujours tester vos reducers</h3>\n<p>Les <code class=\"language-text\">reducers</code> sont les détenteurs de l’activité de votre application.\nIls manipulent l’état de votre application.</p>\n<p><strong>Ce code est donc <em>sensible</em>.</strong></p>\n<p>➡️ Une modification peut avoir beaucoup d’impact sur votre application.</p>\n<p><strong>Ce code est riche en règles de gestion</strong>.</p>\n<p>➡️ Vous devez être sûr que celles-ci sont correctement mises en œuvre.</p>\n<p>La bonne nouvelle est que ce code est relativement facile à tester.\nUn <a href=\"https://redux.js.org/basics/reducers\">reducer</a> est une fonction unique qui prend 2 paramètres.\nCette fonction retournera un nouvel <code class=\"language-text\">state</code> en fonction du type d’action et de ses paramètres.</p>\n<p>Voici la structure standard pour tester les <a href=\"https://redux.js.org/basics/reducers\">reducer</a> avec <a href=\"https://jestjs.io/\">Jest</a> :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ReducerName'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Init a new state</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ACTION'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Group tests by action type</span>\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should test action with some params'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should test action with other params'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SECOND_ACTION'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">it</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should test action with some params'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Je vous recommande également d’utiliser le package <a href=\"https://www.npmjs.com/package/deep-freeze\">deep-freeze</a> sur votre <code class=\"language-text\">state</code> pour vous assurer que toutes les actions retournent de nouvelles références.</p>\n<p>En fin de compte, le fait de tester vos <a href=\"https://redux.js.org/basics/reducers\">reducer</a>s vous permettra de remanier facilement la structure interne de leur état sans risquer d’introduire des régressions.</p>\n<h2 id=\"conserver-limmuabilité-et-la-lisibilité-de-vos-reducers\" style=\"position:relative;\"><a href=\"#conserver-limmuabilit%C3%A9-et-la-lisibilit%C3%A9-de-vos-reducers\" aria-label=\"conserver limmuabilité et la lisibilité de vos reducers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conserver l’immuabilité et la lisibilité de vos reducers</h2>\n<p>Un <a href=\"https://redux.js.org/basics/reducers\">reducer</a> est une fonction qui doit retourner une nouvelle version de l’état contenant ses nouvelles valeurs tout en gardant les mêmes références des objets qui n’ont pas changé.\nCela vous permet de profiter pleinement du <em>partage structurel</em> et d’éviter de faire exploser votre utilisation de la mémoire.\nL’utilisation de l’opérateur <em>spread</em> est donc plus que recommandée.</p>\n<p>Cependant, dans le cas où l’état a une structure compliquée et profonde, il peut être verbeux de changer l’état sans détruire les références qui ne doivent pas changer.</p>\n<p>Par exemple, ici nous voulons surcharger la valeur <code class=\"language-text\">Rhone.Villeurbanne.postal</code> de l’état tout en gardant les objets qui ne changent pas.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  Rhone<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    Lyon<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      postal<span class=\"token operator\">:</span> <span class=\"token string\">'69000'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    Villeurbanne<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      postal<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  Isère<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    Grenoble<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      postal<span class=\"token operator\">:</span> <span class=\"token string\">'39000'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// When you want to change nested state value and use immutability</span>\n<span class=\"token keyword\">const</span> newState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n  Rhone<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>Lyon<span class=\"token punctuation\">,</span>\n    Villeurbanne<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      postal<span class=\"token operator\">:</span> <span class=\"token string\">'69100'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pour éviter cela, <a href=\"https://github.com/flepretre\">un membre de l’équipe Bedrock</a> a publié un paquet qui permet de <code class=\"language-text\">set</code> des attributs imbriqués tout en assurant l’immutabilité : <a href=\"https://www.npmjs.com/package/immutable-set\">immutable-set</a>\nCe paquet est beaucoup plus facile à utiliser que des outils comme <a href=\"https://immutable-js.github.io/immutable-js/\">immutable.js</a> car il n’utilise pas de prototype d’objet.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token keyword\">set</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'immutable-set'</span>\n\n<span class=\"token keyword\">const</span> newState <span class=\"token operator\">=</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Rhone.Villeurbanne.postal</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'69100'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"ne-pas-utiliser-le-cas-par-défaut\" style=\"position:relative;\"><a href=\"#ne-pas-utiliser-le-cas-par-d%C3%A9faut\" aria-label=\"ne pas utiliser le cas par défaut permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ne pas utiliser le cas par défaut</h2>\n<p>L’implémentation d’un <code class=\"language-text\">redux</code> <a href=\"https://redux.js.org/basics/reducers\">reducer</a> consiste très souvent en un <code class=\"language-text\">switch</code> où chaque <code class=\"language-text\">case</code> correspond à une <code class=\"language-text\">action</code>.\nUn <code class=\"language-text\">switch</code> doit toujours définir le cas <code class=\"language-text\">default</code> si vous suivez les règles <code class=\"language-text\">eslint</code> de base.</p>\n<p>Imaginons le <a href=\"https://redux.js.org/basics/reducers\">reducer</a> suivant :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  value<span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span>\n  index<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">initialState<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'FOO'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token operator\">:</span> <span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Nous pouvons dire naïvement que ce <a href=\"https://redux.js.org/basics/reducers\">reducer</a> gère deux actions différentes. Ce n’est pas le cas.\nSi nous isolons ce <a href=\"https://redux.js.org/basics/reducers\">reducer</a>, il n’y a que deux types d‘“actions” qui peuvent changer cet état : l’action “OFO” et toute autre action.</p>\n<p>Cependant, si vous avez suivi le conseil de découper vos reducers, vous n’avez pas qu’un seul reducer agissant sur votre store.</p>\n<p>C’est là que le <a href=\"https://redux.js.org/basics/reducers\">reducer</a> précédent pose problème.\nEn effet, toute autre action changera cet état en un état <code class=\"language-text\">default</code>.\nUne action <code class=\"language-text\">dispatch</code> passera par chacun des reducers associés à celui-ci.\nUne action à l’autre bout de votre application pourrait affecter cet état sans être exprimée dans le code.\nCeci doit être évité.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 721px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADBUlEQVQoz31TS28TZxS9cZJuumgpi/YHdN1KIAES6RTW3aFu+iP4CV1UEVKlKohFi6ApAhKqRIJQIC4JdsKMkzTO+D3jedljeybjGT9jiHFsz8w3H7eyDZuq4kpH93XO0d1cgA/E3NwcIGIIEWf/A3hwbR5wf+/TTox9dMLH/d7B/rATY3+D3Zw9HeaEmbUXiRnxsD999tzFT74+e/6zCxcvnQaY+njxjztXnj/fuM5xsZ/Ww+H5jc3Nawu/LMwBQMiORn42oy8wsnjbZe/eodWtCMIWX4KVZ7uwtLYNGzvq6CJo+wgDRLC6OO4BYLYWTOp3/cwoD1d//9JLxA/NyCba21F0UwkZ9uXmDTZlrGwnKktc2nqwxZdX1Rpdkm1vWXHIsmAOlv/JN/7U6vSebHv3tRq9tyfWV/KHw2WpRu+rsnMVM/z3b7PpH2pPHp+GhNZGLlUZI5ap4G7OQL0VoFbzUW8GqNh9TOtt1Ft0MmsFmCw0Uau7WGwEKDnkYc9sAIopqD9ZAyg0AlI5QlI6IiRZyRI2x5IDnSd6i5CcWSU7Ekc4kSVpo0iKzYAcFNOEEzkSk2KuVO2g6tDVAkFoa8ZHr7YiU6DWfCzUg0CrD2mqrFM2m6Q7+QwVzS7lNZO+zPA0mtyncaVIBaNLd0RhzIlrki/bb1BxgodmB6HUoiHBJgCq478dnV6oB1hqIaq2j7Llomj2UK4OUTRO8EBqoGJ7k5nlolx1x9xig2Lecu8WGwT0ZhDKGgOAVOnkTLrcv5wunzBJvcvkzAEjVj0mbweM1kDmKd+8MH8rfKnUwW8Ey/tWsDxGsFwmqR8zqXLvMl/sfT4yylT68FLoAOQtFxTHB8X2xtBbCKU2QukYQVF1eM3f/EoML3y3l1CgNkTQ25P9e0260p9oHR9YcWIYUhwvJNteSHmHsnE4jTcAjvOLp46kSL8tRbGnPT1PhV+hWlFn3/NGmqwxmBqbOz7EC93/f7ljYQm6iR9hsH0m9Fr+e/2VFJYHhcdf9Avr0FP/mvrQu/4Lfs2JXdzxoq0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/847fbba6812318a026c231349b6a15c2/ba381/combineReducer.webp 200w,\n/static/847fbba6812318a026c231349b6a15c2/7f61c/combineReducer.webp 400w,\n/static/847fbba6812318a026c231349b6a15c2/c71bf/combineReducer.webp 721w\"\n              sizes=\"(max-width: 721px) 100vw, 721px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/847fbba6812318a026c231349b6a15c2/772e8/combineReducer.png 200w,\n/static/847fbba6812318a026c231349b6a15c2/e17e5/combineReducer.png 400w,\n/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png 721w\"\n            sizes=\"(max-width: 721px) 100vw, 721px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/847fbba6812318a026c231349b6a15c2/01dae/combineReducer.png\"\n            alt=\"schéma du reducer combiné\"\n            title=\"schéma du reducer combiné\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Si vous voulez modifier l’état avec une action d’un autre module, vous pouvez le faire en ajoutant un <code class=\"language-text\">case</code> sur cette action.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state <span class=\"token operator\">=</span> initialState<span class=\"token punctuation\">,</span> action</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'FOO'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token operator\">:</span> <span class=\"token string\">'foo'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'otherModule/BAR'</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">return</span> state\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"utiliser-des-middlewares-personnalisés\" style=\"position:relative;\"><a href=\"#utiliser-des-middlewares-personnalis%C3%A9s\" aria-label=\"utiliser des middlewares personnalisés permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Utiliser des middlewares personnalisés</h2>\n<p>J’ai souvent vu des comportements <code class=\"language-text\">action</code> être copiés et collés, d’une action à l’autre.\nQuand on est développeur, le “copier-coller” n’est jamais la bonne méthode.</p>\n<p>L’exemple le plus courant est la gestion des appels HTTP pendant une action qui utilise <code class=\"language-text\">redux-thunk</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">foo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://example.com/api/foo'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'FOO'</span><span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Do something</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">bar</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://example.com/api/bar'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'BAR'</span><span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Do something</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ces deux actions sont fondamentalement la même chose, nous pourrions très bien faire une usine qui ferait le code en commun.</p>\n<p>En gros, l’action <em>meta</em> que nous voulons représenter ici quand elle est <code class=\"language-text\">dispatchée</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Récupérer quelque chose\n-- retourner l'action avec le résultat\n-- en cas d'erreur, faire quelque chose</code></pre></div>\n<p>On pourrait très bien définir un middleware qui s’occuperait de ce comportement.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">http</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">store</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">action</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      action<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// Do something</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// in redux store init</span>\n<span class=\"token keyword\">const</span> exampleApp <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span>reducers<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>exampleApp<span class=\"token punctuation\">,</span> <span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span>http<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ainsi, les deux actions précédentes pourraient être écrites de manière beaucoup plus simple :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">foo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'FOO'</span><span class=\"token punctuation\">,</span> http<span class=\"token operator\">:</span> <span class=\"token string\">'https://example.com/api/foo'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">bar</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'BAR'</span><span class=\"token punctuation\">,</span> http<span class=\"token operator\">:</span> <span class=\"token string\">'https://example.com/api/bar'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Les grands avantages de l’utilisation d’un intergiciel dans une application complexe :</p>\n<ul>\n<li>évite la duplication du code</li>\n<li>vous permet de définir des comportements communs entre vos actions</li>\n<li>standardisation des types d’actions redux <em>meta</em>.</li>\n</ul>\n<h2 id=\"éviter-le-rerender-lié-à-redux\" style=\"position:relative;\"><a href=\"#%C3%A9viter-le-rerender-li%C3%A9-%C3%A0-redux\" aria-label=\"éviter le rerender lié à redux permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Éviter le rerender lié à redux</h2>\n<p>L’astuce quand on utilise redux est de déclencher le re-render des composants quand on les connecte à l’état.\nMême si [les re-render ne sont pas toujours un problème], le re-render causé par l’utilisation de redux doit vraiment être évité.\nIl suffit de se méfier des pièges suivants.</p>\n<h3 id=\"ne-pas-créer-de-référence-dans-le-selector\" style=\"position:relative;\"><a href=\"#ne-pas-cr%C3%A9er-de-r%C3%A9f%C3%A9rence-dans-le-selector\" aria-label=\"ne pas créer de référence dans le selector permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ne pas créer de référence dans le <em>selector</em>.</h3>\n<p>Imaginons le prochain <em>sélecteur</em> :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUserById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">userId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  state<span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> user<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> userId<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ici, le développeur voulait s’assurer que son <em>sélecteur</em> est protégé contre les nullités et renvoie toujours un <em>objet</em>.\nC’est quelque chose que nous voyons assez souvent.</p>\n<p>Chaque fois que ce sélecteur sera appelé pour un <code class=\"language-text\">utilisateur</code> non présent dans l’état, il retournera un nouvel objet, une nouvelle référence.</p>\n<blockquote>\n<p>Avec <a href=\"\">useSelector</a>, retourner un nouvel objet à chaque fois forcera toujours un re-rendu par défaut.\n<a href=\"https://react-redux.js.org/api/hooks#equality-comparisons-and-updates\">Doc de react-redux</a></p>\n</blockquote>\n<p>Cependant, dans le cas d’un objet, comme dans l’exemple ci-dessus (ou d’un tableau), la référence de cette valeur par défaut est nouvelle à chaque fois que le sélecteur est exécuté.\nDe même pour les valeurs par défaut dans la déstructuration, vous ne devriez jamais faire ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUsers</span> <span class=\"token operator\">=</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> users<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    users</code></pre></div>\n<p>Que faire alors ?\nDans la mesure du possible, les valeurs par défaut doivent être stockées dans le reducer.\nSinon, la valeur par défaut doit être extraite dans une constante afin que la référence reste la même.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> defaultUser <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUserById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">userId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  state<span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> user<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> userId<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> defaultUser</code></pre></div>\n<p>Il en va de même pour l’utilisation du sélecteur qui renvoie une nouvelle référence à chaque appel.\nL’utilisation de la fonction <code class=\"language-text\">filter</code> renvoie un nouveau tableau à chaque fois une nouvelle référence même si les conditions du filtre n’ont pas changé.</p>\n<p>Pour continuer, il est important que <a href=\"https://redux.js.org/recipes/usage-with-typescript#typing-the-useselector-hook\">useSelector</a> ne renvoie pas une fonction.\nEn fait, vous ne devez jamais faire cela :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUserById</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">userId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  state<span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> user<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> userId<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> uider <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span>getUserById<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Un sélecteur ne doit pas retourner une <em>vue</em> (une copie) de l’état mais directement ce qu’il contient.\nEn respectant ce principe, vos composants ne se rendront que si une action modifie l’état.\nDes utilitaires tels que <a href=\"https://www.npmjs.com/package/reselect\">reselect</a> peuvent être utilisés pour implémenter des sélecteurs avec un système de mémoire.</p>\n<h3 id=\"ne-transformez-pas-vos-données-dans-les-composants\" style=\"position:relative;\"><a href=\"#ne-transformez-pas-vos-donn%C3%A9es-dans-les-composants\" aria-label=\"ne transformez pas vos données dans les composants permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ne transformez pas vos données dans les composants</h3>\n<p>Parfois, les données contenues dans le <code class=\"language-text\">state</code> ne sont pas dans le bon format d’affichage.\nNous aurions rapidement tendance à la générer directement dans le composant.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MyComponent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span>getUser<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://profil-pic.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ici, l’url de l’image est calculée dynamiquement dans le composant, et donc à chaque rendu.\nNous préférons modifier nos reducers afin d’inclure un attribut <code class=\"language-text\">profileUrl</code> pour que cette information soit directement accessible.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">case</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">user/SET_USER</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token operator\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n      user<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>action<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">,</span>\n        profilUrl<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://profil-pic.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>action<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Ces informations sont ensuite calculées une fois par action et non à chaque fois qu’elles sont rendues.</p>\n<h2 id=\"nutilisez-pas-usereducer-pour-vos-données-professionnelles\" style=\"position:relative;\"><a href=\"#nutilisez-pas-usereducer-pour-vos-donn%C3%A9es-professionnelles\" aria-label=\"nutilisez pas usereducer pour vos données professionnelles permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>N’utilisez pas <em>useReducer</em> pour vos données professionnelles</h2>\n<p>Depuis l’arrivée des hooks, nous avons beaucoup plus d’outils fournis directement par React pour gérer l’état de nos composants.\nLe hook <a href=\"https://fr.reactjs.org/docs/hooks-reference.html#usereducer\">useReducer</a> permet de définir un état qui pourra être modifié par des actions.\nOn est vraiment très très proche d’un état redux que l’on peut associer à un composant, c’est génial.</p>\n<p>Cependant, si vous utilisez redux dans votre application, il semble assez étrange de devoir utiliser <a href=\"https://fr.reactjs.org/docs/hooks-reference.html#usereducer\">useReducer</a>.\nVous avez déjà tout ce dont vous avez besoin pour manipuler un état complexe.</p>\n<p>De plus, en utilisant redux au lieu du hook <a href=\"https://fr.reactjs.org/docs/hooks-reference.html#usereducer\">useReducer</a>, vous pouvez profiter d’outils de développement et de middlewares vraiment efficaces.</p>\n<hr>\n<h2 id=\"ressources-utiles\" style=\"position:relative;\"><a href=\"#ressources-utiles\" aria-label=\"ressources utiles permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ressources utiles</h2>\n<ul>\n<li><a href=\"https://redux.js.org/basics/usage-with-react\">Utiliser react avec redux</a></li>\n<li><a href=\"https://github.com/reduxjs/redux/issues/653#issuecomment-216844781\">flux redux animé par Dan Abramov</a>\n<img src=\"/404460ceece985d433e1ed1f36cd4215/redux-flow.gif\" alt=\"flux redux animé par Dan Abramov\"></li>\n<li><a href=\"https://redux.js.org/api/applymiddleware\">documentation redux sur les middlewares</a></li>\n<li><a href=\"https://www.npmjs.com/package/immutable-set\">immutable-set</a></li>\n</ul>\n<p>Merci aux relecteurs :\n<a href=\"https://github.com/flepretre\">@flepretre</a>,\n<a href=\"https://github.com/mfrachet\">@mfrachet</a>,\n<a href=\"https://github.com/fdubost\">@fdubost</a>,\n<a href=\"https://github.com/ncuillery\">@ncuillery</a>,\n<a href=\"https://github.com/renaudAmsellem\">@renaudAmsellem</a>_</p>","image":["https://blog.slashgear.dev/static/ee72c19029938b25ca14c9387d5095ab/6edcc/redux.jpg","https://blog.slashgear.dev/static/ee72c19029938b25ca14c9387d5095ab/e14ae/redux.jpg","https://blog.slashgear.dev/static/ee72c19029938b25ca14c9387d5095ab/db124/redux.jpg"],"keywords":["react","redux","web"],"author":{"@type":"Person","name":"Antoine Caron"},"publisher":{"@type":"Organization","name":"Antoine Caron","logo":{"@type":"ImageObject","url":"https://blog.slashgear.dev/static/picture_of_me-cb64a6913d2e31dbb5dab1f4d113d077.jpg"}}}</script><div class="editOnGithubcomponent__Wrapper-sc-zzrn7j-0 szUMw"><a href="https://github.com/Slashgear/slashgear.github.io/edit/source/src/pages/fr/react-redux-pieges-bonnes-pratiques/index.md" target="_blank" rel="noreferrer">Edit this page on Github</a></div></div><aside id="table-of-content" class="tableOfContentscomponent__Aside-sc-ep791a-0 kJjENl"><header class="tableOfContentscomponent__Heading-sc-ep791a-1 gJZcwq">Table of content</header><nav><ul>
<li>
<p><a href="#%C3%A9vitez-davoir-un-seul-reducer">Évitez d’avoir un seul reducer</a></p>
<ul>
<li><a href="#acc%C3%A8s-par-proxy-%C3%A0-l%C3%A9tat">Accès par proxy à l’état</a></li>
<li><a href="#pr%C3%A9fixer-le-nom-de-vos-actions">Préfixer le nom de vos actions</a></li>
<li><a href="#toujours-tester-vos-reducers">Toujours tester vos reducers</a></li>
</ul>
</li>
<li>
<p><a href="#conserver-limmuabilit%C3%A9-et-la-lisibilit%C3%A9-de-vos-reducers">Conserver l’immuabilité et la lisibilité de vos reducers</a></p>
</li>
<li>
<p><a href="#ne-pas-utiliser-le-cas-par-d%C3%A9faut">Ne pas utiliser le cas par défaut</a></p>
</li>
<li>
<p><a href="#utiliser-des-middlewares-personnalis%C3%A9s">Utiliser des middlewares personnalisés</a></p>
</li>
<li>
<p><a href="#%C3%A9viter-le-rerender-li%C3%A9-%C3%A0-redux">Éviter le rerender lié à redux</a></p>
<ul>
<li><a href="#ne-pas-cr%C3%A9er-de-r%C3%A9f%C3%A9rence-dans-le-selector">Ne pas créer de référence dans le <em>selector</em>.</a></li>
<li><a href="#ne-transformez-pas-vos-donn%C3%A9es-dans-les-composants">Ne transformez pas vos données dans les composants</a></li>
</ul>
</li>
<li>
<p><a href="#nutilisez-pas-usereducer-pour-vos-donn%C3%A9es-professionnelles">N’utilisez pas <em>useReducer</em> pour vos données professionnelles</a></p>
</li>
<li>
<p><a href="#ressources-utiles">Ressources utiles</a></p>
</li>
</ul></nav></aside></main><hr style="margin-bottom:1.75rem"/><div id="bio" class="biocomponent__Wrapper-sc-1oo1jyu-0 jzTCVn"><div class="biocomponent__Image-sc-1oo1jyu-1 huLTfH gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:150px;height:150px;margin:0 1.2rem 0 0"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMFAf/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAG3IRvHRVI4AjTXCH//xAAcEAACAwADAQAAAAAAAAAAAAABAwACEQQSEyH/2gAIAQEAAQUC6wYZku3yCW1pAY761gycU6n/xAAYEQACAwAAAAAAAAAAAAAAAAAAAQIQEf/aAAgBAwEBPwFRMpn/xAAYEQACAwAAAAAAAAAAAAAAAAAAAQIQEv/aAAgBAgEBPwFzNUj/xAAdEAABAgcAAAAAAAAAAAAAAAAAASECEBExUWFx/9oACAEBAAY/AhpUV9GCxF0QQ//EABwQAAICAgMAAAAAAAAAAAAAAAABESEQYUFRsf/aAAgBAQABPyFCLOFTLjQbQ1B6JVPsazoJp6GSuKP/2gAMAwEAAgADAAAAEGQPAv/EABkRAAMAAwAAAAAAAAAAAAAAAAABERAxQf/aAAgBAwEBPxBMbuHDY//EABgRAAIDAAAAAAAAAAAAAAAAAAABEBEx/9oACAECAQE/EKGlLB//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFxYZHw/9oACAEBAAE/EKNkyAJaeoOtRKluqcd8RmOi2rb9uUoCJYmDFbmiHgMEWoc82bH3R0M//9k=" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source type='image/webp' srcset="/static/6d4845a20dbe813a1019a37775ca875f/763d7/picture_of_me.webp 1x,
/static/6d4845a20dbe813a1019a37775ca875f/13190/picture_of_me.webp 1.5x,
/static/6d4845a20dbe813a1019a37775ca875f/9a9e1/picture_of_me.webp 2x" /><source srcset="/static/6d4845a20dbe813a1019a37775ca875f/81545/picture_of_me.jpg 1x,
/static/6d4845a20dbe813a1019a37775ca875f/b4472/picture_of_me.jpg 1.5x,
/static/6d4845a20dbe813a1019a37775ca875f/18255/picture_of_me.jpg 2x" /><img loading="lazy" width="150" height="150" srcset="/static/6d4845a20dbe813a1019a37775ca875f/81545/picture_of_me.jpg 1x,
/static/6d4845a20dbe813a1019a37775ca875f/b4472/picture_of_me.jpg 1.5x,
/static/6d4845a20dbe813a1019a37775ca875f/18255/picture_of_me.jpg 2x" src="/static/6d4845a20dbe813a1019a37775ca875f/81545/picture_of_me.jpg" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div><p>Ecrit par <strong>Antoine Caron</strong> qui vit et travaille à Lyon et développe des choses utiles à <a href="https://www.bedrockstreaming.com/">Bedrock</a>.
Tu devrais le suivre sur <a href="https://twitter.com/Slashgear_">Twitter</a>.
N’hésites pas à aller voir <a href="/conferences">ses conférences sur la page dédiée</a>.
Si vous voulez voir mon parcours pro, <a href="/resume">mon CV est disponible ici en 🇬🇧</a>.</p></div></div><a id="foundation" class="foundationcomponent__StyledLink-sc-hocuye-3 gsWdLS" href="/fr/abbe-pierre"><div class="foundationcomponent__TextWrapper-sc-hocuye-1 eTWzsT">Si vous aimez le contenu de ce blog, ou bien qu&#x27;il vous a aidé, s&#x27;il vous plait, considérez donner à la fondation Abbé Pierre que je soutiens personnellement.<br/><blockquote class="foundationcomponent__Blocquote-sc-hocuye-2 icQYkE">“On n’est jamais heureux que dans le bonheur qu’on donne. Donner, c’est recevoir.”</blockquote></div><div class="foundationcomponent__Logo-sc-hocuye-0 iegdlW gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:151px;height:150px"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAMBBP/aAAwDAQACEAMQAAAB6dY2l0+esnashAb/AP/EABoQAAIDAQEAAAAAAAAAAAAAAAIRAAEDECL/2gAIAQEAAQUCzEbs8hrmJKaH4JON8//EABYRAQEBAAAAAAAAAAAAAAAAAAESIP/aAAgBAwEBPwFWsf/EABYRAQEBAAAAAAAAAAAAAAAAABEBIP/aAAgBAgEBPwGBj//EAB4QAAEDBAMAAAAAAAAAAAAAAAEAAhEQEiAhIjFB/9oACAEBAAY/AuSNp68odS5EOEOWsP/EABoQAQEBAAMBAAAAAAAAAAAAAAERABAxQSH/2gAIAQEAAT8hZ1DEJL2XBQKOshYB8nup4GFGjHK7K8f/2gAMAwEAAgADAAAAEPQ4wv/EABoRAAICAwAAAAAAAAAAAAAAAAABECERgfD/2gAIAQMBAT8Qq12hWjEf/8QAFhEAAwAAAAAAAAAAAAAAAAAAASAx/9oACAECAQE/EAqn/8QAHBABAAICAwEAAAAAAAAAAAAAAREhADEQUWHR/9oACAEBAAE/EKk0IJhVyIm5BNecB1Jj38yvtWwtcOJKaQPa3hpQaRhyKrCCWYOP/9k=" alt="logo de la fondation abbé pierre" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source type='image/webp' srcset="/static/907eb9bd5732972738e42845f14772cc/7307a/abbe_pierre.webp 1x,
/static/907eb9bd5732972738e42845f14772cc/305a6/abbe_pierre.webp 1.5x,
/static/907eb9bd5732972738e42845f14772cc/75eb0/abbe_pierre.webp 2x" /><source srcset="/static/907eb9bd5732972738e42845f14772cc/e2676/abbe_pierre.jpg 1x,
/static/907eb9bd5732972738e42845f14772cc/20600/abbe_pierre.jpg 1.5x,
/static/907eb9bd5732972738e42845f14772cc/e48d1/abbe_pierre.jpg 2x" /><img loading="lazy" width="151" height="150" srcset="/static/907eb9bd5732972738e42845f14772cc/e2676/abbe_pierre.jpg 1x,
/static/907eb9bd5732972738e42845f14772cc/20600/abbe_pierre.jpg 1.5x,
/static/907eb9bd5732972738e42845f14772cc/e48d1/abbe_pierre.jpg 2x" src="/static/907eb9bd5732972738e42845f14772cc/e2676/abbe_pierre.jpg" alt="logo de la fondation abbé pierre" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></a><aside><header><h2>Related posts:</h2></header><ul class="listcomponent__List-sc-1nc5peu-0 jZYdzq"><li data-testid="related-post" class="listcomponent__ListItem-sc-1nc5peu-1 blog-post__RelatedPost-sc-hrojot-1 bJPulw gGeUFs"><h3 style="margin-bottom:0.4375rem"><a style="box-shadow:none" href="/fr/comment-ne-pas-jeter-son-application-au-bout-de-deux-ans/">Bonnes pratiques pour la maintenance d&#x27;une application web</a></h3><span><time dateTime="2021-08-25">August 25, 2021</time></span><span style="margin:0 1rem"><span role="img" aria-label="Time to read">🕐</span>22<!-- --> min</span><span><a style="margin-right:0.5rem" href="/fr/web">#<!-- -->web</a><a style="margin-right:0.5rem" href="/fr/javascript">#<!-- -->javascript</a><a style="margin-right:0.5rem" href="/fr/bedrock">#<!-- -->bedrock</a></span><p>Comment ne pas jeter son application tous les deux ans ? Retour d’expérience basé sur les bonnes pratiques appliquées à la plateforme web…</p></li><li data-testid="related-post" class="listcomponent__ListItem-sc-1nc5peu-1 blog-post__RelatedPost-sc-hrojot-1 bJPulw gGeUFs"><h3 style="margin-bottom:0.4375rem"><a style="box-shadow:none" href="/fr/use-reduced-motion/">Et voici use-reduced-motion!</a></h3><span><time dateTime="2020-05-01">May 01, 2020</time></span><span style="margin:0 1rem"><span role="img" aria-label="Time to read">🕐</span>3<!-- --> min</span><span><a style="margin-right:0.5rem" href="/fr/react">#<!-- -->react</a><a style="margin-right:0.5rem" href="/fr/a11y">#<!-- -->a11y</a></span><p>Tout part toujours d’une idée La semaine dernière, alors que je mettais en place le mode sombre sur mon site perso, je me suis motivé à…</p></li></ul></aside><footer class="footercomponent__FooterWrapper-sc-1ogqr1t-0 eOaYOT blog-post__SocialFooter-sc-hrojot-2 eRQrRu"><div><a href="https://github.com/Slashgear">Github</a> • <a href="https://twitter.com/Slashgear_">Twitter</a> • <a href="https://www.linkedin.com/in/antoine-caron-7089788a">LinkedIn</a> • <a href="https://dev.to/slashgear_">DevTo</a> • <a href="https://medium.com/@Slashgear_">Medium</a> • <a href="https://hackernoon.com/u/antoinecaron">HackerNoon</a></div><div><a href="/rss.xml">RSS</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-77930802-1',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-77930802-1', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/fr/react-redux-pieges-bonnes-pratiques/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-01614f818c41ea663aa8.js"],"app":["/app-debec287bb0edc82497f.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-1865d152649ebf0c34dd.js"],"component---src-pages-404-js":["/component---src-pages-404-js-1148a9ee27e73a864786.js"],"component---src-pages-abbe-pierre-js":["/component---src-pages-abbe-pierre-js-20709280402fcb611ad3.js"],"component---src-pages-conferences-js":["/component---src-pages-conferences-js-1afd0ca480e11498ecce.js"],"component---src-pages-fr-abbe-pierre-js":["/component---src-pages-fr-abbe-pierre-js-ff56b789cb631e434551.js"],"component---src-pages-friends-you-should-follow-js":["/component---src-pages-friends-you-should-follow-js-59fd32b325c76f6e882a.js"],"component---src-pages-resume-js":["/component---src-pages-resume-js-1d90729fdea99c851a17.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-87408a0a8bd850bdef1f.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-3f39259a86d41f0d38d4.js"],"component---src-templates-tag-list-js":["/component---src-templates-tag-list-js-eea844902c18f8e4cc32.js"]};/*]]>*/</script><script src="/polyfill-01614f818c41ea663aa8.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-3f39259a86d41f0d38d4.js" async=""></script><script src="/982adfec591605b2489416210e2fcf136d466ade-3e3c46a1fafbb8d43538.js" async=""></script><script src="/743791b12bf7cb00b427fac0e2749395f37c471f-8be1a0076bf43c0356de.js" async=""></script><script src="/6cc983252ef082d05857c6f27e42306283885478-339e699220b88e754e05.js" async=""></script><script src="/app-debec287bb0edc82497f.js" async=""></script><script src="/framework-008207b94a0d8e7b1e0d.js" async=""></script><script src="/webpack-runtime-1be07eacdecde6e37a2e.js" async=""></script></body></html>